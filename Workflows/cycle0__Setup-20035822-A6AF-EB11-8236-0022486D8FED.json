{
    "properties": {
        "connectionReferences": {
            "shared_commondataserviceforapps": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedcommondataserviceforapps_188d9"
                },
                "api": {
                    "name": "shared_commondataserviceforapps"
                }
            },
            "shared_flowmanagement": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedflowmanagement_f1091"
                },
                "api": {
                    "name": "shared_flowmanagement"
                }
            },
            "shared_webcontents_1": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_connref_shared_webcontents"
                },
                "api": {
                    "name": "shared_webcontents"
                }
            },
            "shared_sharepointonline": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedsharepointonline_9ad14"
                },
                "api": {
                    "name": "shared_sharepointonline"
                }
            },
            "shared_sharepointonline_1": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedsharepointonline_9ad14"
                },
                "api": {
                    "name": "shared_sharepointonline"
                }
            },
            "shared_microsoftflowforadmins": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedmicrosoftflowforadmins_2680d"
                },
                "api": {
                    "name": "shared_microsoftflowforadmins"
                }
            }
        },
        "definition": {
            "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
            "contentVersion": "1.0.0.0",
            "parameters": {
                "$connections": {
                    "defaultValue": {},
                    "type": "Object"
                },
                "$authentication": {
                    "defaultValue": {},
                    "type": "SecureObject"
                },
                "envpar_config__CycleZeroName": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__CycleZeroName",
                        "description": "Required. Could have many environments N each with its envN_cycle0 template"
                    }
                },
                "envpar_config__TenantName": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__TenantName",
                        "description": "Required. Org Name orgname (this is the prefix of the auto assigned domain orgname.onmicrosoft.com)"
                    }
                },
                "envpar_config__CyclesRename": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__CyclesRename",
                        "description": "Required. Rename cycle to class, for example. So now class1, ... classN"
                    }
                },
                "envpar_config__TenantDomain": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__TenantDomain",
                        "description": "Required. Org Domain name such as orgname.onmicrosoft.com or orgname.com"
                    }
                },
                "envpar_config__CyclesNumber": {
                    "defaultValue": 5,
                    "type": "Int",
                    "metadata": {
                        "schemaName": "new_envpar_config__CyclesNumber",
                        "description": "Required. Total number N of cycles from cycle1 to cycleN"
                    }
                }
            },
            "triggers": {
                "manual": {
                    "metadata": {
                        "operationMetadataId": "2689589a-c978-4202-b9cf-903407a4f913"
                    },
                    "type": "Request",
                    "kind": "Http",
                    "inputs": {
                        "method": "GET"
                    }
                }
            },
            "actions": {
                "List_rows_Environment": {
                    "runAfter": {
                        "Apply_to_each_Flow": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "b3791f8f-44e0-4755-bfbf-1deb2b78d53a"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                        "host": {
                            "connectionName": "shared_commondataserviceforapps",
                            "operationId": "ListRecords",
                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                            "entityName": "environmentvariablevalues",
                            "$top": 1000
                        },
                        "authentication": "@parameters('$authentication')"
                    }
                },
                "List_Flows_as_Admin": {
                    "runAfter": {
                        "SETUP_MANUAL": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "b1499d5b-6d14-4818-80c3-5f183e68c348"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                        "host": {
                            "connectionName": "shared_flowmanagement",
                            "operationId": "ListFlowsInEnvironment",
                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                        },
                        "parameters": {
                            "environmentName": "@workflow()?['tags']?['environmentName']"
                        },
                        "authentication": "@parameters('$authentication')"
                    }
                },
                "Apply_to_each_Flow": {
                    "foreach": "@body('Filter_array_Flows')",
                    "actions": {
                        "Compose_setProperty": {
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "30176b18-c23f-4be3-adc5-57ba63032dae"
                            },
                            "type": "Compose",
                            "inputs": "@setProperty(variables('AllFlows'), items('Apply_to_each_Flow')?['properties/displayName'], items('Apply_to_each_Flow')?['name'])"
                        },
                        "Set_variable_AllFlows": {
                            "runAfter": {
                                "Compose_setProperty": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "a6af0a91-3134-4a0a-8168-0c16e57da39f"
                            },
                            "type": "SetVariable",
                            "inputs": {
                                "name": "AllFlows",
                                "value": "@outputs('Compose_setProperty')"
                            }
                        }
                    },
                    "runAfter": {
                        "Filter_array_Flows": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "c5774d15-f2df-4ca0-91eb-a4a5604e05ba"
                    },
                    "type": "Foreach"
                },
                "Initialize_variable_envpar_id__AllFlows": {
                    "runAfter": {},
                    "metadata": {
                        "operationMetadataId": "e48efb63-b1bc-413d-a956-0d2bc1918c74"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "envpar_id__AllFlows",
                                "type": "object",
                                "value": {}
                            }
                        ]
                    }
                },
                "Filter_array_Flows": {
                    "runAfter": {
                        "List_Flows_as_Admin": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "3764f6e7-c1d7-466a-8044-10e4a0711147"
                    },
                    "type": "Query",
                    "inputs": {
                        "from": "@outputs('List_Flows_as_Admin')?['body/value']",
                        "where": "@startsWith(item()?['properties/displayName'], 'cycle0__')"
                    }
                },
                "Initialize_variable_AllFlows": {
                    "runAfter": {
                        "Initialize_variable_envpar_id__AllFlows": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "94eda47c-8839-4125-9271-e654cc83535d"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "AllFlows",
                                "type": "object",
                                "value": {}
                            }
                        ]
                    }
                },
                "Initialize_variable_AllEnvs": {
                    "runAfter": {
                        "Initialize_variable_AllFlows": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "b34a2012-085b-4bc9-b993-78633e83bcf1"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "AllEnvs",
                                "type": "object",
                                "value": {}
                            }
                        ]
                    }
                },
                "Apply_to_each_AllEnvs": {
                    "foreach": "@outputs('List_rows_Environment')?['body/value']",
                    "actions": {
                        "Compose_AllEnvs_setProperty": {
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "42834ed7-24b7-4476-be40-79df1402304e"
                            },
                            "type": "Compose",
                            "inputs": "@setProperty(variables('AllEnvs'), items('Apply_to_each_AllEnvs')?['_environmentvariabledefinitionid_value@OData.Community.Display.V1.FormattedValue'], items('Apply_to_each_AllEnvs')?['environmentvariablevalueid'])"
                        },
                        "Set_variable_AllEnvs": {
                            "runAfter": {
                                "Compose_AllEnvs_setProperty": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "f86134b8-439f-4dce-9598-ef77815d514f"
                            },
                            "type": "SetVariable",
                            "inputs": {
                                "name": "AllEnvs",
                                "value": "@outputs('Compose_AllEnvs_setProperty')"
                            }
                        }
                    },
                    "runAfter": {
                        "List_rows_Environment": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "ee045796-45ec-4776-8f6b-f02327d1b8ce"
                    },
                    "type": "Foreach"
                },
                "Scope_Apps_Registrations": {
                    "actions": {
                        "Scope_App_Sign": {
                            "actions": {
                                "Condition_App_Sign": {
                                    "actions": {
                                        "Create_App_Sign": {
                                            "runAfter": {
                                                "List_Callback_URL_AzureAD_Signed_2": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "f0036a77-88b2-44d8-9256-feef10d41dcd"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n    \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#applications/$entity\",\n    \"displayName\": \"WorkSchool 365 Sign App__@{parameters('envpar_config__CycleZeroName')}\",\n    \"info\": {\n        \"logoUrl\": \"https://workschool365.com\",\n        \"marketingUrl\": \"https://workschool365.com\",\n        \"privacyStatementUrl\": \"https://workschool365.com\",\n        \"supportUrl\": \"https://workschool365.com\",\n        \"termsOfServiceUrl\": \"https://workschool365.com\"\n    },\n    \"web\": {\n        \"homePageUrl\": \"https://@{parameters('envpar_config__TenantName')}.workschool365.com\",\n        \"implicitGrantSettings\": {\n            \"enableIdTokenIssuance\": true,\n            \"enableAccessTokenIssuance\": true\n        },\n        \"redirectUris\": [\n            \"@{outputs('List_Callback_URL_AzureAD_Signed_2')?['body/response/value']}\"\n        ]\n    },\n    \"requiredResourceAccess\": [\n        {\n            \"resourceAppId\": \"00000003-0000-0000-c000-000000000000\",\n            \"resourceAccess\": [\n                {\n                    \"id\": \"e1fe6dd8-ba31-4d61-89e7-88639da4683d\",\n                    \"type\": \"Scope\"\n                }\n            ]\n        }\n    ],\n    \"signInAudience\": \"AzureADMyOrg\"\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Secret_App_Sign": {
                                            "runAfter": {
                                                "Create_App_Sign": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "f04eac91-08b4-4866-901e-2f5418904a6d"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications/@{outputs('Create_App_Sign')?['body']?['id']}/addPassword",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n  \"passwordCredential\": {\n    \"displayName\": \"WorkSchool 365 Sign Secret__@{parameters('envpar_config__CycleZeroName')}\",\n  }\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Update_a_row_App_Sign": {
                                            "runAfter": {
                                                "Set_variable_LoginAppId": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "d9a52fc5-f13a-485f-83a1-37c91bbc8e55"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_commondataserviceforapps",
                                                    "operationId": "UpdateRecord",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                },
                                                "parameters": {
                                                    "entityName": "environmentvariablevalues",
                                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__LoginAppId']",
                                                    "item/value": "@outputs('Create_App_Sign')?['body']?['appId']"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Update_a_row_App_Sign_Secret": {
                                            "runAfter": {
                                                "Update_a_row_App_Sign": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "de917cfe-024f-4253-83e1-e82db632ece7"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_commondataserviceforapps",
                                                    "operationId": "UpdateRecord",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                },
                                                "parameters": {
                                                    "entityName": "environmentvariablevalues",
                                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__LoginAppSecret']",
                                                    "item/value": "@outputs('Secret_App_Sign')?['body']?['secretText']"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "List_Callback_URL_AzureAD_Signed_2": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "8e92cb8a-3ae8-4b05-ab14-2eb8c1d10c7e"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_flowmanagement",
                                                    "operationId": "ListCallbackUrl",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                                },
                                                "parameters": {
                                                    "environmentName": "@workflow()?['tags']?['environmentName']",
                                                    "flowName": "@variables('AllFlows')?['cycle0__AzureAD_Signed']"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Set_variable_LoginAppId": {
                                            "runAfter": {
                                                "Secret_App_Sign": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "22d2cbd5-e965-4b57-afb6-5483fe11ec5a"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "LoginAppId",
                                                "value": "@{outputs('Create_App_Sign')?['body']?['appId']}"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_LoginAppId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Set_variable_LoginAppId_existing": {
                                                "runAfter": {},
                                                "metadata": {
                                                    "operationMetadataId": "dc987480-421e-4313-900f-ecbe93927fc8"
                                                },
                                                "type": "SetVariable",
                                                "inputs": {
                                                    "name": "LoginAppId",
                                                    "value": "@{outputs('Get_a_row_by_AllEnvs_LoginAppId')?['body/value']}"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "equals": [
                                            "@trim(string(outputs('Get_a_row_by_AllEnvs_LoginAppId')?['body/value']))",
                                            "@''"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "1bc0fe94-3135-40bb-836f-6a90b7986fc8"
                                    },
                                    "type": "If"
                                },
                                "Get_a_row_by_AllEnvs_LoginAppId": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "3fe1e7e6-3575-4f32-bce7-c8e077fe7288"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__LoginAppId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Apps_Registrations_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "85cd2812-3bb9-4e01-a59d-483ce02b4ab7"
                            },
                            "type": "Scope"
                        },
                        "Scope_App_Graph": {
                            "actions": {
                                "Condition_App_Graph": {
                                    "actions": {
                                        "Create_App_Graph": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "19d4329d-06b3-4bbb-8b15-4cf9815bf5c5"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n    \"@@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#applications/$entity\",\n    \"displayName\": \"WorkSchool 365 Graph App__@{parameters('envpar_config__CycleZeroName')}\",\n\"requiredResourceAccess\": [\n    {\n        \"resourceAppId\": \"00000003-0000-0000-c000-000000000000\",\n        \"resourceAccess\": [\n            {\n                \"id\": \"d01b97e9-cbc0-49fe-810a-750afd5527a3\",\n                \"type\": \"Scope\"\n            },\n            {\n                \"id\": \"46ca0847-7e6b-426e-9775-ea810a948356\",\n                \"type\": \"Scope\"\n            },\n            {\n                \"id\": \"e1fe6dd8-ba31-4d61-89e7-88639da4683d\",\n                \"type\": \"Scope\"\n            },\n            {\n                \"id\": \"f13ce604-1677-429f-90bd-8a10b9f01325\",\n                \"type\": \"Scope\"\n            },\n            {\n                \"id\": \"883ea226-0bf2-4a8f-9f9d-92c9162a727d\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"332a536c-c7ef-4017-ab91-336970924f0d\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9492366f-7969-46a4-8d15-ed1a20078fff\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"a267235f-af13-44dc-8385-c1dc93023186\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"c9090d00-6101-42f0-a729-c41074260d47\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9f1b81a7-0223-4428-bfa4-0bcb5535f27d\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"999f8c63-0a38-4f1b-91fd-ed1947bdd1a9\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"2044e4f1-e56c-435b-925c-44cd8f6ba89a\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9e3f62cf-ca93-4989-b6ce-bf83c28f9fe8\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"292d869f-3427-49a8-9dab-8c70152b74e9\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"913b9306-0ce1-42b8-9137-6a7df690a760\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"79a677f7-b79d-40d0-a36a-3e6f8688dd7a\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"90db2b9a-d928-4d33-a4dd-8442ae3d41e4\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"5eb59dd3-1da2-4329-8733-9dabdc435916\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"09850681-111b-4a89-9bed-3f2cae46d706\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"75359482-378d-4052-8f01-80520e7db3cd\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"294ce7c9-31ba-490a-ad7d-97a7d075e4ed\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"db06fb33-1953-4b7b-a2ac-f1e2c854f7ae\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"656f6061-f9fe-4807-9708-6a2e0934df76\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9bc431c3-b8bc-4a8d-a219-40f10f92eff6\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"741f803b-c850-494e-b5df-cde7c675a1ca\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"405a51b5-8d8d-430b-9842-8be4b0e9f324\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"60a901ed-09f7-4aa5-a16e-7dd3d6f9de36\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"ef5f7d5c-338f-44b0-86c3-351f46c8bb5f\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"b528084d-ad10-4598-8b93-929746b4d7d6\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"7e847308-e030-4183-9899-5235d7270f58\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"7b2449af-6ccd-4f4d-9f78-e550c193f0d1\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"4d02b0cc-d90b-441f-8d82-4fb55c34d6bb\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"1bfefb4e-e0b5-418b-a88f-73c46d2cc8e9\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"7e05723c-0bb0-42da-be95-ae9f08a6e53c\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"62a82d76-70ea-41e2-9197-370581804d09\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"19dbc75e-c2e2-444c-a770-ec69d8559fc7\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"ef54d2bf-783f-4e0f-bca1-3210c0444d99\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"65319a09-a2be-469d-8782-f6b07debf789\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"b8bb2037-6e08-44ac-a4ea-4674e010e2a4\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"e1a88a34-94c4-4418-be12-c87b00e26bea\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"06b708a9-e830-4db3-a914-8e69da51d44f\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"70dec828-f620-4914-aa83-a29117306807\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"854d9ab1-6657-4ec8-be45-823027bcd009\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"2f6817f8-7b12-4f0f-bc18-eeaf60705a9e\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"6f9d5abc-2db6-400b-a267-7de22a40fb87\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"60182ac6-4565-4baa-8b04-9350fe8dbfca\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"fbfdecc9-4b78-4882-bb98-7decbddcbddf\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"afe5c674-a576-4b80-818c-e3d7f6afd299\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"5f411d27-abad-4dc3-83c6-b84a46ffa434\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"eb6b3d76-ed75-4be6-ac36-158d04c0a555\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"4e774092-a092-48d1-90bd-baad67c7eb47\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"dbaae8cf-10b5-4b86-a4a1-f871c94c6695\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"b7760610-0545-4e8a-9ec3-cce9e63db01c\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"01c0a623-fc9b-48e9-b794-0756f8e8f067\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"50483e42-d915-4231-9639-7fdb7fd190e5\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"a96d855f-016b-47d7-b51c-1218a98d791c\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"be74164b-cff1-491c-8741-e671cb536e13\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"c529cfca-c91b-489c-af2b-d92990b66ce6\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"a82116e5-55eb-4c41-a434-62fe8a61c773\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"0c0bf378-bf22-4481-8f81-9e89a9b4960a\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"f3a65bd4-b703-46df-8f7e-0174fea562aa\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"6a118a39-1227-45d4-af0c-ea7b40d210bc\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"c97b873f-f59f-49aa-8a0e-52b32d762124\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"243cded2-bd16-4fd6-a953-ff8177894c3d\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"2280dda6-0bfd-44ee-a2f4-cb867cfc4c1e\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"59a6b24b-4225-4393-8165-ebaec5f55d7a\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"bdd80a03-d9bc-451d-b7c4-ce7c63fe3c8f\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"0121dc95-1b9f-4aed-8bac-58c5ac466691\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"3b55498e-47ec-484f-8136-9013221c06a9\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"35930dcf-aceb-4bd1-b99a-8ffed403c974\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"25f85f3c-f66c-4205-8cd5-de92dd7f0cec\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"29c18626-4985-4dcd-85c0-193eef327366\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"fb221be6-99f2-473f-bd32-01c6a0e9ca3b\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"a402ca1c-2696-4531-972d-6e5ee4aa11ea\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"dfb0dd15-61de-45b2-be36-d6a69fba3c79\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9e19bae1-2623-4c4f-ab6e-2664615ff9a0\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"5dad17ba-f6cc-4954-a5a2-a0dcc95154f0\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"74ef0291-ca83-4d02-8c7e-d2391e6a444f\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"73a45059-f39c-4baf-9182-4954ac0e55cf\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9f67436c-5415-4e7f-8ac1-3014a7132630\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"908de74d-f8b2-4d6b-a9ed-2a17b3b78179\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"23fc2474-f741-46ce-8465-674744c5c361\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"4437522e-9a86-4a41-a7da-e380edd4a97d\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"b9bb2381-47a4-46cd-aafb-00cb12f68504\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"fd9ce730-a250-40dc-bd44-8dc8d20f39ea\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"6163d4f4-fbf8-43da-a7b4-060fe85ed148\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"425b4b59-d5af-45c8-832f-bb0b7402348a\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"1dfe531a-24a6-4f1b-80f4-7a0dc5a0a171\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"57257249-34ce-4810-a8a2-a03adf0c5693\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"d9c48af6-9ad9-47ad-82c3-63757137b9af\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"df021288-bdef-4463-88db-98f22de89214\",\n                \"type\": \"Role\"\n            }\n        ]\n    },\n    {\n        \"resourceAppId\": \"00000003-0000-0ff1-ce00-000000000000\",\n        \"resourceAccess\": [\n            {\n                \"id\": \"678536fe-1083-478a-9c59-b99265e6b0d3\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"9bff6588-13f2-4c48-bbf2-ddab62256b36\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"d13f72ca-a275-4b96-b789-48ebcc4da984\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"fbcd29d2-fcca-4405-aded-518d457caae4\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"2a8d57a5-4090-4a41-bf1c-3c621d2ccad3\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"c8e3537c-ec53-43b9-bed3-b2bd3617ae97\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"df021288-bdef-4463-88db-98f22de89214\",\n                \"type\": \"Role\"\n            },\n            {\n                \"id\": \"741f803b-c850-494e-b5df-cde7c675a1ca\",\n                \"type\": \"Role\"\n            }\n        ]\n    }\n],\n    \"signInAudience\": \"AzureADMyOrg\"\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Secret_App_Graph": {
                                            "runAfter": {
                                                "Create_App_Graph": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "330638db-05b4-41ed-8b11-f40574836a0d"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications/@{outputs('Create_App_Graph')?['body']?['id']}/addPassword",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n  \"passwordCredential\": {\n    \"displayName\": \"WorkSchool 365 Graph Secret__@{parameters('envpar_config__CycleZeroName')}\",\n  }\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Set_variable_GraphAppId": {
                                            "runAfter": {
                                                "Secret_App_Graph": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "38d6bb96-8956-4bc1-9fd0-29b1a9c47483"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "GraphAppId",
                                                "value": "@{body('Create_App_Graph')?['appId']}"
                                            }
                                        },
                                        "Set_variable_GraphAppSecret": {
                                            "runAfter": {
                                                "Set_variable_GraphAppId": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "6caec9ab-f36c-4edc-b356-5888e925e002"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "GraphAppSecret",
                                                "value": "@{body('Secret_App_Graph')?['secretText']}"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_GraphAppSecret": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Set_variable_GraphAppId_Env": {
                                                "runAfter": {},
                                                "metadata": {
                                                    "operationMetadataId": "eb586089-22c8-4e81-b16c-9a9ade9c0438"
                                                },
                                                "type": "SetVariable",
                                                "inputs": {
                                                    "name": "GraphAppId",
                                                    "value": "@{outputs('Get_a_row_by_AllEnvs_GraphAppId')?['body/value']}"
                                                }
                                            },
                                            "Set_variable_GraphAppSecret_Env": {
                                                "runAfter": {
                                                    "Set_variable_GraphAppId_Env": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "9e0aab9e-8421-4c78-bd95-b1244d900d0d"
                                                },
                                                "type": "SetVariable",
                                                "inputs": {
                                                    "name": "GraphAppSecret",
                                                    "value": "@{outputs('Get_a_row_by_AllEnvs_GraphAppSecret')?['body/value']}"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "equals": [
                                            "@trim(string(outputs('Get_a_row_by_AllEnvs_GraphAppId')?['body/value']))",
                                            "@''"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "cc4c7c34-2423-4c0f-91ab-102a9c23a4a0"
                                    },
                                    "type": "If"
                                },
                                "Get_a_row_by_AllEnvs_GraphAppId": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "c24e5e5b-22a6-4d5c-8408-b01b6f54a2dc"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GraphAppId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_App_Graph_Secret": {
                                    "runAfter": {
                                        "Update_a_row_App_Graph": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "c202b975-63b8-46f6-ae55-e335c40eb3d3"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GraphAppSecret']",
                                            "item/value": "@variables('GraphAppSecret')"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_App_Graph": {
                                    "runAfter": {
                                        "Condition_App_Graph": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "0e1bf76f-513e-4667-929b-e691bbb35815"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GraphAppId']",
                                            "item/value": "@variables('GraphAppId')"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_GraphAppSecret": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_GraphAppId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "52381f28-9ed5-41c6-9bac-17f5cde2c95d"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GraphAppSecret']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Apps_Registrations_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "1804bdc6-e2f0-49bf-ab50-5f93764c67ac"
                            },
                            "type": "Scope"
                        },
                        "Scope_App_Microsoft": {
                            "actions": {
                                "Condition_App_Microsoft": {
                                    "actions": {
                                        "Create_App_Microsoft": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "43e115d6-2d65-429e-b8ef-7d579db2dd8c"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n    \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#applications/$entity\",\n    \"displayName\": \"WorkSchool 365 Microsoft App__@{parameters('envpar_config__CycleZeroName')}\",\n\t\"requiredResourceAccess\": [\n\t\t{\n\t\t\t\"resourceAppId\": \"00000003-0000-0000-c000-000000000000\",\n\t\t\t\"resourceAccess\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"e1fe6dd8-ba31-4d61-89e7-88639da4683d\",\n\t\t\t\t\t\"type\": \"Scope\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n    \"signInAudience\": \"AzureADMyOrg\"\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Secret_App_Microsoft": {
                                            "runAfter": {
                                                "Create_App_Microsoft": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "d3eda958-0a52-405b-85d2-7e9c632cc024"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/applications/@{outputs('Create_App_Microsoft')?['body']?['id']}/addPassword",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n  \"passwordCredential\": {\n    \"displayName\": \"WorkSchool 365 Microsoft Secret__@{parameters('envpar_config__CycleZeroName')}\",\n  }\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Update_a_row_App_Microsoft": {
                                            "runAfter": {
                                                "Secret_App_Microsoft": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "8847cea0-46fc-4d4f-a763-efab337dc121"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_commondataserviceforapps",
                                                    "operationId": "UpdateRecord",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                },
                                                "parameters": {
                                                    "entityName": "environmentvariablevalues",
                                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__MicrosoftAppId']",
                                                    "item/value": "@outputs('Create_App_Microsoft')?['body']?['appId']"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        },
                                        "Update_a_row_App_Microsoft_Secret": {
                                            "runAfter": {
                                                "Update_a_row_App_Microsoft": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "bdacab7e-cb85-47fd-96e6-e616542091ff"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_commondataserviceforapps",
                                                    "operationId": "UpdateRecord",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                },
                                                "parameters": {
                                                    "entityName": "environmentvariablevalues",
                                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__MicrosoftAppSecret']",
                                                    "item/value": "@outputs('Secret_App_Microsoft')?['body']?['secretText']"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_MicrosoftAppId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "expression": {
                                        "equals": [
                                            "@trim(string(outputs('Get_a_row_by_AllEnvs_MicrosoftAppId')?['body/value']))",
                                            ""
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "f3e2bd1c-5a49-484c-b573-2ef27404aace"
                                    },
                                    "type": "If"
                                },
                                "Get_a_row_by_AllEnvs_MicrosoftAppId": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "79a8617d-b689-4c04-b766-36c17f01f90c"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GraphAppId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Apps_Registrations_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "76508512-61a5-4d5c-a68b-e93ce8cc93a8"
                            },
                            "type": "Scope"
                        },
                        "Scope_Apps_Registrations_0": {
                            "actions": {},
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "b1d0c8cb-c5aa-4748-b8f0-6f0470beaf6d"
                            },
                            "type": "Scope"
                        },
                        "Scope_User_Flow": {
                            "actions": {
                                "User_Flow_Add_Identity_Email": {
                                    "runAfter": {
                                        "Delay_30s": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "3d4d553b-3879-42af-811b-16b5a97e05ca"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "POST",
                                            "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows/B2X_1_WorkSchool365__@{parameters('envpar_config__CycleZeroName')}/identityProviders/$ref",
                                            "request/headers": {
                                                "Content-type": "application/json"
                                            },
                                            "request/body": "{\n    \"@odata.id\": \"https://graph.microsoft.com/v1.0/identityProviders/EmailOtpSignup-OAUTH\"\n}\n"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "User_Flow_Add_Identity_MSAccount": {
                                    "runAfter": {
                                        "User_Flow_Add_Identity_Email": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "3307c73a-5cb6-4341-a9a1-a5b48b0c4d1b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "POST",
                                            "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows/B2X_1_WorkSchool365__@{parameters('envpar_config__CycleZeroName')}/identityProviders/$ref",
                                            "request/headers": {
                                                "Content-type": "application/json"
                                            },
                                            "request/body": "{\n    \"@odata.id\": \"https://graph.microsoft.com/v1.0/identityProviders/MSASignup-OAUTH\"\n}\n"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Get_a_row_by_AllEnvs_GoogleAppId": {
                                    "runAfter": {
                                        "User_Flow_Add_Identity_MSAccount": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "bef0e522-5348-4169-9440-f23d10ad98b8"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__GoogleAppId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Condition_GoogleApp": {
                                    "actions": {},
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_GoogleAppId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Get_a_row_by_AllEnvs_GoogleAppSecret": {
                                                "runAfter": {},
                                                "metadata": {
                                                    "operationMetadataId": "b1711950-d02b-40aa-99a0-5372b2db4801"
                                                },
                                                "type": "OpenApiConnection",
                                                "inputs": {
                                                    "host": {
                                                        "connectionName": "shared_commondataserviceforapps",
                                                        "operationId": "GetItem",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                    },
                                                    "parameters": {
                                                        "entityName": "environmentvariablevalues",
                                                        "recordId": "@variables('AllEnvs')?['new_envpar_config__GoogleAppSecret']"
                                                    },
                                                    "authentication": "@parameters('$authentication')"
                                                }
                                            },
                                            "Scope_Fail_Create_Identity_Google": {
                                                "actions": {},
                                                "runAfter": {
                                                    "Create_Identity_Google": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "dff51d75-807e-440c-9742-03daf6635b18"
                                                },
                                                "type": "Scope"
                                            },
                                            "User_Flow_Add_Identity_Google": {
                                                "runAfter": {
                                                    "Scope_Fail_Create_Identity_Google": [
                                                        "Succeeded",
                                                        "Skipped"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "d6e32a43-8b3e-4adc-a084-f29728647a0e"
                                                },
                                                "type": "OpenApiConnection",
                                                "inputs": {
                                                    "host": {
                                                        "connectionName": "shared_webcontents_1",
                                                        "operationId": "InvokeHttp",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                    },
                                                    "parameters": {
                                                        "request/method": "POST",
                                                        "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows/B2X_1_WorkSchool365__@{parameters('envpar_config__CycleZeroName')}/identityProviders/$ref",
                                                        "request/headers": {
                                                            "Content-type": "application/json"
                                                        },
                                                        "request/body": "{\n    \"@odata.id\": \"https://graph.microsoft.com/v1.0/identityProviders/Google-OAUTH\"\n}\n"
                                                    },
                                                    "authentication": "@parameters('$authentication')"
                                                }
                                            },
                                            "Scope_Fail_User_Flow_Add_Identity_Google": {
                                                "actions": {},
                                                "runAfter": {
                                                    "User_Flow_Add_Identity_Google": [
                                                        "Failed"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "81a4622d-6e3b-4625-be89-4318c90cc2d6"
                                                },
                                                "type": "Scope"
                                            },
                                            "Create_Identity_Google": {
                                                "runAfter": {
                                                    "Get_a_row_by_AllEnvs_GoogleAppSecret": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "0f5ad21b-c67e-460e-93f3-4987e454a191"
                                                },
                                                "type": "Http",
                                                "inputs": {
                                                    "method": "POST",
                                                    "uri": "https://graph.microsoft.com/v1.0/identityProviders",
                                                    "headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "body": {
                                                        "name": "Google",
                                                        "type": "Google",
                                                        "clientId": "@{outputs('Get_a_row_by_AllEnvs_GoogleAppId')?['body/value']}",
                                                        "clientSecret": "@{outputs('Get_a_row_by_AllEnvs_GoogleAppSecret')?['body/value']}"
                                                    },
                                                    "authentication": {
                                                        "type": "ActiveDirectoryOAuth",
                                                        "tenant": "@parameters('envpar_config__TenantDomain')",
                                                        "audience": "https://graph.microsoft.com",
                                                        "clientId": "@variables('GraphAppId')",
                                                        "secret": "@variables('GraphAppSecret')"
                                                    },
                                                    "host": {
                                                        "connectionName": "shared_webcontents_1",
                                                        "operationId": "InvokeHttp",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                    },
                                                    "parameters": {
                                                        "request/method": "POST",
                                                        "request/url": "https://graph.microsoft.com/v1.0/identityProviders",
                                                        "request/headers": {
                                                            "Content-type": "application/json"
                                                        },
                                                        "request/body": "{\n    \"name\": \"Google\",\n    \"type\": \"Google\",\n    \"clientId\": \"@{outputs('Get_a_row_by_AllEnvs_GoogleAppId')?['body/value']}\",\n    \"clientSecret\": \"@{outputs('Get_a_row_by_AllEnvs_GoogleAppSecret')?['body/value']}\"\n}"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "equals": [
                                            "@trim(string(outputs('Get_a_row_by_AllEnvs_GoogleAppId')?['body/value']))",
                                            ""
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "f6e215c1-529a-47cf-b5b5-e5538a940bd6"
                                    },
                                    "type": "If"
                                },
                                "Get_User_Flow": {
                                    "runAfter": {
                                        "Auth_Flow_Policy_Email": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "db38d8a4-3983-41a6-a4e8-709808e0f07a"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "GET",
                                            "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows/B2X_1_WorkSchool365__@{parameters('envpar_config__CycleZeroName')}",
                                            "request/headers": {
                                                "Content-type": "application/json"
                                            }
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Condition_FacebookApp": {
                                    "actions": {},
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_FacebookAppId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Get_a_row_by_AllEnvs_FacebookAppSecret": {
                                                "runAfter": {},
                                                "metadata": {
                                                    "operationMetadataId": "8cf4d66f-de05-4806-9155-62f6962576d4"
                                                },
                                                "type": "OpenApiConnection",
                                                "inputs": {
                                                    "host": {
                                                        "connectionName": "shared_commondataserviceforapps",
                                                        "operationId": "GetItem",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                    },
                                                    "parameters": {
                                                        "entityName": "environmentvariablevalues",
                                                        "recordId": "@variables('AllEnvs')?['new_envpar_config__FacebookAppSecret']"
                                                    },
                                                    "authentication": "@parameters('$authentication')"
                                                }
                                            },
                                            "Scope_Fail_Create_Identity_Facebook": {
                                                "actions": {},
                                                "runAfter": {
                                                    "Create_Identity_Facebook": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "0eb0b2e6-1f9f-40ef-bf11-ba8836ed4369"
                                                },
                                                "type": "Scope"
                                            },
                                            "User_Flow_Add_Identity_Facebook": {
                                                "runAfter": {
                                                    "Scope_Fail_Create_Identity_Facebook": [
                                                        "Succeeded",
                                                        "Skipped"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "c8077ffc-c475-4fea-981d-5dc8abf7fb0e"
                                                },
                                                "type": "OpenApiConnection",
                                                "inputs": {
                                                    "host": {
                                                        "connectionName": "shared_webcontents_1",
                                                        "operationId": "InvokeHttp",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                    },
                                                    "parameters": {
                                                        "request/method": "POST",
                                                        "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows/B2X_1_WorkSchool365__@{parameters('envpar_config__CycleZeroName')}/identityProviders/$ref",
                                                        "request/headers": {
                                                            "Content-type": "application/json"
                                                        },
                                                        "request/body": "{\n    \"@odata.id\": \"https://graph.microsoft.com/v1.0/identityProviders/Facebook-OAUTH\"\n}\n"
                                                    },
                                                    "authentication": "@parameters('$authentication')"
                                                }
                                            },
                                            "Scope_Fail_User_Flow_Add_Identity_Facebook": {
                                                "actions": {},
                                                "runAfter": {
                                                    "User_Flow_Add_Identity_Facebook": [
                                                        "Failed"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "3d7d8baa-cd8a-4846-af28-cdc8d6f70714"
                                                },
                                                "type": "Scope"
                                            },
                                            "Create_Identity_Facebook": {
                                                "runAfter": {
                                                    "Get_a_row_by_AllEnvs_FacebookAppSecret": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "84b5275e-e6a1-42c6-b2a9-1b60c4d59a0d"
                                                },
                                                "type": "Http",
                                                "inputs": {
                                                    "method": "POST",
                                                    "uri": "https://graph.microsoft.com/v1.0/identityProviders",
                                                    "headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "body": {
                                                        "name": "Facebook",
                                                        "type": "Facebook",
                                                        "clientId": "@{outputs('Get_a_row_by_AllEnvs_FacebookAppId')?['body/value']}",
                                                        "clientSecret": "@{outputs('Get_a_row_by_AllEnvs_FacebookAppSecret')?['body/value']}"
                                                    },
                                                    "authentication": {
                                                        "type": "ActiveDirectoryOAuth",
                                                        "tenant": "@parameters('envpar_config__TenantDomain')",
                                                        "audience": "https://graph.microsoft.com",
                                                        "clientId": "@variables('GraphAppId')",
                                                        "secret": "@variables('GraphAppSecret')"
                                                    },
                                                    "host": {
                                                        "connectionName": "shared_webcontents_1",
                                                        "operationId": "InvokeHttp",
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                    },
                                                    "parameters": {
                                                        "request/method": "POST",
                                                        "request/url": "https://graph.microsoft.com/v1.0/identityProviders",
                                                        "request/headers": {
                                                            "Content-type": "application/json"
                                                        },
                                                        "request/body": "{\n    \"name\": \"Facebook\",\n    \"type\": \"Facebook\",\n    \"clientId\": \"@{outputs('Get_a_row_by_AllEnvs_FacebookAppId')?['body/value']}\",\n    \"clientSecret\": \"@{outputs('Get_a_row_by_AllEnvs_FacebookAppSecret')?['body/value']}\"\n}"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "equals": [
                                            "@trim(string(outputs('Get_a_row_by_AllEnvs_FacebookAppId')?['body/value']))",
                                            ""
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "00c3a7cd-2f0d-4f17-9920-0afb4452ca45"
                                    },
                                    "type": "If"
                                },
                                "Get_a_row_by_AllEnvs_FacebookAppId": {
                                    "runAfter": {
                                        "User_Flow_Add_Identity_MSAccount": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "14056f4c-7a7f-4cb3-8a8c-79b4471a3221"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__FacebookAppId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Delay_30s": {
                                    "runAfter": {
                                        "Scope_Create_User_Flow": [
                                            "Succeeded",
                                            "Skipped"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "4f13723a-a451-4800-9ebe-37a584a299c7"
                                    },
                                    "type": "Wait",
                                    "inputs": {
                                        "interval": {
                                            "count": 30,
                                            "unit": "Second"
                                        }
                                    }
                                },
                                "Delay_1min_App_Registrations": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "41649499-9999-4949-b2c2-0c9e68b888dc"
                                    },
                                    "type": "Wait",
                                    "inputs": {
                                        "interval": {
                                            "count": 1,
                                            "unit": "Minute"
                                        }
                                    }
                                },
                                "Auth_Flow_Policy_Email": {
                                    "runAfter": {
                                        "Delay_1min_App_Registrations": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "34e92b54-da3d-4d58-87ae-fafc9a7e22f0"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "PATCH",
                                        "uri": "https://graph.microsoft.com/beta/policies/authenticationFlowsPolicy",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "selfServiceSignUp": {
                                                "isEnabled": true
                                            }
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        }
                                    }
                                },
                                "Scope_Create_User_Flow": {
                                    "actions": {
                                        "Delay_To_Create_User_Flow": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "18a03880-df4c-470b-acdc-364c3ddba98f"
                                            },
                                            "type": "Wait",
                                            "inputs": {
                                                "interval": {
                                                    "count": 30,
                                                    "unit": "Second"
                                                }
                                            }
                                        },
                                        "Create_User_Flow": {
                                            "runAfter": {
                                                "Delay_To_Create_User_Flow": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "d58f1cf6-a275-43d5-b6f0-a857ddb9eeca"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connectionName": "shared_webcontents_1",
                                                    "operationId": "InvokeHttp",
                                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                                },
                                                "parameters": {
                                                    "request/method": "POST",
                                                    "request/url": "https://graph.microsoft.com/v1.0/identity/b2xUserFlows",
                                                    "request/headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "request/body": "{\n    \"id\": \"WorkSchool365__@{parameters('envpar_config__CycleZeroName')}\",\n    \"userFlowType\": \"signUpOrSignIn\",\n    \"userFlowTypeVersion\": 1\n}"
                                                },
                                                "authentication": "@parameters('$authentication')"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Get_User_Flow": [
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "867a7671-6732-4248-9f4d-60f39d3af421"
                                    },
                                    "type": "Scope"
                                }
                            },
                            "runAfter": {
                                "Scope_App_Graph": [
                                    "Succeeded"
                                ],
                                "Scope_App_Microsoft": [
                                    "Succeeded"
                                ],
                                "Scope_App_Sign": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "bca9ed57-2609-49b4-9533-7b7eba83d6f4"
                            },
                            "type": "Scope"
                        }
                    },
                    "runAfter": {
                        "Apply_to_each_AllEnvs": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "f411c5e9-adc8-4650-8fa8-afe64e41cb25"
                    },
                    "type": "Scope"
                },
                "Scope_Misc": {
                    "actions": {
                        "Scope_Misc0": {
                            "actions": {},
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "95887fee-5ec0-487e-bb3d-0ad5f6256296"
                            },
                            "type": "Scope"
                        },
                        "Scope_AdminId": {
                            "actions": {
                                "Get_a_row_by_AllEnvs_config_AdminId": {
                                    "runAfter": {
                                        "Set_variable_AdminEmail": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "a70d52a8-5591-45c8-a96f-46fe1373dbc0"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_config__AdminId']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_AdminId": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_config_AdminId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "eccb9199-ab1d-4336-a139-5266a9baddc7"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_config_AdminId')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@variables('AdminId')"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "HTTP_Get_Graph_Admin": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "6a212307-bc8a-4dd3-8656-11ca9dac0f2a"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "GET",
                                            "request/url": "https://graph.microsoft.com/v1.0/me/?$select=id,mail,userPrincipalName,otherMails",
                                            "request/headers": {
                                                "Content-Type": "application/json"
                                            }
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Set_variable_AdminId": {
                                    "runAfter": {
                                        "HTTP_Get_Graph_Admin": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "c3faf6eb-dcb3-4cc3-93d7-7fe5589c1334"
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "AdminId",
                                        "value": "@{outputs('HTTP_Get_Graph_Admin')?['body']?['id']}"
                                    }
                                },
                                "Set_variable_AdminEmail": {
                                    "runAfter": {
                                        "Set_variable_AdminId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "66b835b0-ba10-4e72-b688-e353c74865f1"
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "AdminEmail",
                                        "value": "@{coalesce(outputs('HTTP_Get_Graph_Admin')?['body']?['mail'], outputs('HTTP_Get_Graph_Admin')?['body']?['otherMails']?[0], outputs('HTTP_Get_Graph_Admin')?['body']?['userPrincipalName'])}"
                                    }
                                },
                                "HTTP_TenantId": {
                                    "runAfter": {
                                        "Update_a_row_AdminId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "3fc905c6-9b04-450a-9d68-db361d19c102"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "GET",
                                            "request/url": "https://graph.microsoft.com/v1.0/organization/?$select=id",
                                            "request/headers": {
                                                "Content-type": "application/json"
                                            }
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Scope_Fail_HTTP_Tenant_Branding": {
                                    "actions": {},
                                    "runAfter": {
                                        "HTTP_Tenant_Branding": [
                                            "Failed",
                                            "Skipped",
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "3ac50eac-b851-47e8-9cee-d611e04ef604"
                                    },
                                    "type": "Scope"
                                },
                                "HTTP_Tenant_Branding": {
                                    "runAfter": {
                                        "HTTP_Patch_Tenant_Branding": [
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "414a586f-71c3-4d03-90f4-6e7bdb5c6b9a"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "POST",
                                        "uri": "https://graph.microsoft.com/v1.0/organization/@{body('HTTP_TenantId')?['value']?[0]?['id']}/branding/localizations",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "signInPageText": "@{outputs('Compose_Branding')}",
                                            "usernameHintText": "Already Enrolled? Enter your Email",
                                            "id": "en"
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        },
                                        "host": {
                                            "connectionName": "shared_webcontents_1",
                                            "operationId": "InvokeHttp",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                                        },
                                        "parameters": {
                                            "request/method": "PATCH",
                                            "request/url": "https://graph.microsoft.com/v1.0/organization/@{body('HTTP_TenantId')?['value']?[0]?['id']}/branding/localizations/0",
                                            "request/headers": {
                                                "Content-type": "application/json"
                                            },
                                            "request/body": "{\n\"signInPageText\": \"++**@{parameters('envpar_config__TenantName')} WorkSchool 365**++\\nNot Yet Enrolled?\\nSign-up here: [@{parameters('envpar_config__TenantName')}.WorkSchool365.com](https://@{parameters('envpar_config__TenantName')}.WorkSchool365.com), click *Create one!* via **Microsoft** or **Google** or **Facebook** or **Any Email** (or **Azure AD** Email), or click *Sign-in options*\\n**Preview As Anonymous: [@{parameters('envpar_config__TenantName')}-reviews.WorkSchool365.com](https://@{parameters('envpar_config__TenantName')}-reviews.WorkSchool365.com)\\nWorkSchool 365 CRM & LMS  for Quiz & Review with Transcript & Receipt + Payments\\n[Terms](https://WorkSchool365.com) | [Privacy](https://WorkSchool365.com)|  2021\",\n            \"usernameHintText\": \"Already Enrolled? Enter your Email\"\n}"
                                        }
                                    }
                                },
                                "Compose_Branding": {
                                    "runAfter": {
                                        "HTTP_TenantId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "a522c1ec-84ef-417d-a013-32cfbd18c776"
                                    },
                                    "type": "Compose",
                                    "inputs": "++**@{parameters('envpar_config__TenantName')} WorkSchool 365**++\n\nNot Yet Enrolled?\n\nSign-up here: [@{parameters('envpar_config__TenantName')}.WorkSchool365.com](https://@{parameters('envpar_config__TenantName')}.WorkSchool365.com), click *Create one!* via **Microsoft** or **Google** or **Facebook** or **Any Email** (or **Azure AD** Email), or click *Sign-in options*\n\nBuy Your Own: **[Microsoft Marketplace](https://appsource.microsoft.com/en-us/product/web-apps/anthroplogicworkschool3651593890930054.anthroplogic_workschool_365)**\n\nPreview As Anonymous: [@{parameters('envpar_config__TenantName')}-reviews.WorkSchool365.com](https://@{parameters('envpar_config__TenantName')}-reviews.WorkSchool365.com)  [@{parameters('envpar_config__TenantName')}-quiz.WorkSchool365.com](https://@{parameters('envpar_config__TenantName')}-quiz.WorkSchool365.com)\n\nWorkSchool 365 CRM & LMS for SharePoint Teams  [Open Source Code](https://github.com/1337777/workschool365) Secure Microsoft 365 App with PayPal + Stripe Payments\n\n[Terms](https://WorkSchool365.com) | [Privacy](https://WorkSchool365.com)|  @{utcNow('yyyy')} Canada"
                                },
                                "HTTP_Patch_Tenant_Branding": {
                                    "runAfter": {
                                        "Compose_Branding": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "7097c65e-d205-4ca3-b565-2d71956f3925"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "PATCH",
                                        "uri": "https://graph.microsoft.com/v1.0/organization/@{body('HTTP_TenantId')?['value']?[0]?['id']}/branding/localizations/en",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "signInPageText": "@{outputs('Compose_Branding')}",
                                            "usernameHintText": "Already Enrolled? Enter your Email"
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        }
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Misc0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "89985cbe-5f14-47c9-a0d9-d66f7f77d592"
                            },
                            "type": "Scope"
                        },
                        "Scope_AllFlows_Template": {
                            "actions": {
                                "Apply_to_each_Flow_Template": {
                                    "foreach": "@body('Filter_array_Flows_Template')",
                                    "actions": {
                                        "Set_variable_envpar_id__AllFlows": {
                                            "runAfter": {
                                                "Compose_setProperty_Template": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "5d01428c-6cd4-4976-899b-5aaeca3ce5fb"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "envpar_id__AllFlows",
                                                "value": "@outputs('Compose_setProperty_Template')"
                                            }
                                        },
                                        "Compose_setProperty_Template": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "1206f998-55c5-4d75-b496-5cd68d1d01b5"
                                            },
                                            "type": "Compose",
                                            "inputs": "@setProperty(variables('envpar_id__AllFlows'), items('Apply_to_each_Flow_Template')?['properties/displayName'], items('Apply_to_each_Flow_Template')?['name'])"
                                        }
                                    },
                                    "runAfter": {
                                        "Filter_array_Flows_Template": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "34a9e99e-2b7f-481d-b0b9-4c4efaedb6ec"
                                    },
                                    "type": "Foreach"
                                },
                                "Filter_array_Flows_Template": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "0915fcd1-1598-4cd4-bdab-6bea5642d7da"
                                    },
                                    "type": "Query",
                                    "inputs": {
                                        "from": "@body('Filter_array_Flows')",
                                        "where": "@endswith(item()?['properties']?['displayName'], 'Template')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_id_AllFlows": {
                                    "runAfter": {
                                        "Apply_to_each_Flow_Template": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "573d0c45-1e4e-4b65-ae80-50395ec1d0d5"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_id__AllFlows']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_AllFlows": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_id_AllFlows": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "f6df428b-e66a-492e-baa0-ff87f47333ed"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_id_AllFlows')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@string(variables('envpar_id__AllFlows'))"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Misc0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "905d238e-bcca-45ea-b614-01e388fd23b9"
                            },
                            "type": "Scope"
                        },
                        "Scope_conn_sharedsharepointonline": {
                            "actions": {
                                "List_rows_connref_sharedsharepointonline": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "4b04c168-41e8-4361-b08d-10e0494726ae"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "ListRecords",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "connectionreferences",
                                            "$filter": "connectionreferencelogicalname eq 'new_sharedsharepointonline_9ad14'"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_conn_sharedsharepointonline": {
                                    "runAfter": {
                                        "List_rows_connref_sharedsharepointonline": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "fb3fc72d-9692-4849-8b2e-c6c1d9f9e684"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_conn_sharedsharepointonline']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_conn_sharedsharepointonline": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_conn_sharedsharepointonline": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "08df701a-739a-415d-b383-e93294a0ead6"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_conn_sharedsharepointonline')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_rows_connref_sharedsharepointonline')?['body/value']?[0]?['connectionid']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Misc0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "d683dc26-bb80-4aa2-af93-98924c3b2871"
                            },
                            "type": "Scope"
                        }
                    },
                    "runAfter": {
                        "Scope_Apps_Registrations": [
                            "Succeeded",
                            "Failed"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "edb648ce-4a6e-4797-b85e-5bb6cfb39054"
                    },
                    "type": "Scope"
                },
                "Scope_Http": {
                    "actions": {
                        "Scope_Http_0": {
                            "actions": {},
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "fc133efb-2e02-4fdc-abd2-baddbaafdaa9"
                            },
                            "type": "Scope"
                        },
                        "Scope_SurveyQuiz": {
                            "actions": {
                                "List_Callback_URL_SurveyQuiz": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "8a8211c1-5e3e-4102-9c5d-5fb489878123"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__SurveyQuiz']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_SurveyQuiz": {
                                    "runAfter": {
                                        "List_Callback_URL_SurveyQuiz": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "2357a8f1-8b9e-4ff8-b224-8eb606965cb7"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__SurveyQuiz']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_SurveyQuiz": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_SurveyQuiz": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "fb60450b-9b54-4407-9bcc-69a6bbf9bfd7"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_SurveyQuiz')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_SurveyQuiz')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "585a7cd9-39f7-4b40-88cb-4f8341a081d0"
                            },
                            "type": "Scope"
                        },
                        "Scope_EventReview": {
                            "actions": {
                                "List_Callback_URL_EventReview": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "21b79070-d3db-4740-bf61-fafd6f2604ec"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__EventReview']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_EventReview": {
                                    "runAfter": {
                                        "List_Callback_URL_EventReview": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "4dc37190-865e-4d85-b74a-80ee04fbf70d"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__EventReview']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_EventReview": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_EventReview": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "3d47c840-bf08-4389-b7b5-65be1714a3bf"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_EventReview')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_EventReview')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "66e56326-491f-450c-96cf-9afc20e76ab8"
                            },
                            "type": "Scope"
                        },
                        "Scope_EventReview__Delete": {
                            "actions": {
                                "List_Callback_URL_EventReview__Delete": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "28f1c70f-e6f9-466e-8f23-a82e4eb2b6c6"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__EventReview__Delete']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_EventReview__Delete": {
                                    "runAfter": {
                                        "List_Callback_URL_EventReview__Delete": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "d968036e-e6d4-4fd6-9724-9cfb8c753e6e"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__EventReview__Delete']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_EventReview__Delete": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_EventReview__Delete": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "ca47b216-03f3-47ba-b04a-0d1fb9177b0b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_EventReview__Delete')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_EventReview__Delete')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "8003bea3-b6ea-40a8-a8a6-0627b853c30d"
                            },
                            "type": "Scope"
                        },
                        "Scope_Flow_TriggerUri": {
                            "actions": {
                                "List_Callback_URL_Flow_TriggerUri": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "59efac87-156a-4816-a299-c864c8726d62"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Flow_TriggerUri']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Flow_TriggerUri": {
                                    "runAfter": {
                                        "List_Callback_URL_Flow_TriggerUri": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "2834c522-768e-4b78-964a-b1fbc33dd2bb"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Flow_TriggerUri']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Flow_TriggerUri": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Flow_TriggerUri": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "35ba3f60-ea93-4a55-a67a-b5d78ef7405e"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Flow_TriggerUri')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Flow_TriggerUri')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "3aa8617b-ec8b-4224-9200-84e41e159a56"
                            },
                            "type": "Scope"
                        },
                        "Scope_Graph_Notifications_Interface": {
                            "actions": {
                                "List_Callback_URL_Graph_Notifications_Interface": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "d0ec1626-526a-4232-8918-349989131360"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Graph_Notifications_Interface']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Graph_Notifications_Interface": {
                                    "runAfter": {
                                        "List_Callback_URL_Graph_Notifications_Interface": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "14214653-3ab2-4886-a562-e7044c9bd13c"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Graph_Notifications_Interface']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Graph_Notifications_Interface": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Graph_Notifications_Interface": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "d1f49e1d-5df2-4405-a85c-613cee7e5d86"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Graph_Notifications_Interface')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Graph_Notifications_Interface')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "abb293bc-dff3-4a2b-932d-38803320128f"
                            },
                            "type": "Scope"
                        },
                        "Scope_Microsoft_Contact_Webhook": {
                            "actions": {
                                "List_Callback_URL_Microsoft_Contact_Webhook": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "ab3a8dca-177c-4cd4-831b-a937227ba7b9"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Microsoft_Contact_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Microsoft_Contact_Webhook": {
                                    "runAfter": {
                                        "List_Callback_URL_Microsoft_Contact_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "f75b7335-97af-4077-a0dc-b260a71ca0bf"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Microsoft_Contact_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Microsoft_Contact_Webhook": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Microsoft_Contact_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "95cbd3af-4d25-4a7f-9c8b-6e879add176a"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Microsoft_Contact_Webhook')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Microsoft_Contact_Webhook')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "cc0f721a-8cdb-4f26-9f7f-b28f09120820"
                            },
                            "type": "Scope"
                        },
                        "Scope_Microsoft_Create_Webhook": {
                            "actions": {
                                "List_Callback_URL_Microsoft_Create_Webhook": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "5f28885c-a7bb-4462-893b-193d98e68e63"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Microsoft_Create_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Microsoft_Create_Webhook": {
                                    "runAfter": {
                                        "List_Callback_URL_Microsoft_Create_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "757a161d-d6c5-4939-806d-5551a17fb4bc"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Microsoft_Create_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Microsoft_Create_Webhook": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Microsoft_Create_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "b476ec40-6720-4307-9c61-4be9c4096620"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Microsoft_Create_Webhook')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Microsoft_Create_Webhook')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "252e0c74-8684-4635-b088-01990a94a365"
                            },
                            "type": "Scope"
                        },
                        "Scope_Microsoft_Update_Webhook": {
                            "actions": {
                                "List_Callback_URL_Microsoft_Update_Webhook": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "8777bb76-9eb8-4d96-aeca-828cc6662018"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Microsoft_Update_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Microsoft_Update_Webhook": {
                                    "runAfter": {
                                        "List_Callback_URL_Microsoft_Update_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "cb6e1f8e-7afc-4b16-a35b-9bc8232ee62b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Microsoft_Update_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Microsoft_Update_Webhook": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Microsoft_Update_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "294e9ee7-74c2-47f9-9bbd-d1119e7deb1b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Microsoft_Update_Webhook')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Microsoft_Update_Webhook')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "7f5d59fc-9165-49d3-aae2-18867c0c3c20"
                            },
                            "type": "Scope"
                        },
                        "Scope_MySubscriptions": {
                            "actions": {
                                "List_Callback_URL_MySubscriptions": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "d281ea06-2d85-437a-8476-a12993a7da10"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__MySubscriptions']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_MySubscriptions": {
                                    "runAfter": {
                                        "List_Callback_URL_MySubscriptions": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "d7f8a4df-e38c-4f50-bfde-8f328e7589c3"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__MySubscriptions']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_MySubscriptions": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_MySubscriptions": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "a563d1eb-a8dc-4597-875b-fd89cecaf72b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_MySubscriptions')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_MySubscriptions')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "5d3f663a-dfca-4bfd-8dd8-2a7c644dc318"
                            },
                            "type": "Scope"
                        },
                        "Scope_Paypal_Webhook": {
                            "actions": {
                                "List_Callback_URL_Paypal_Webhook": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "e8715a92-d3ed-41d2-af94-fcae6849617b"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Paypal_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Paypal_Webhook": {
                                    "runAfter": {
                                        "List_Callback_URL_Paypal_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "25370382-757f-4282-842b-739d43023c71"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Paypal_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Paypal_Webhook": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Paypal_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "6fd212b1-ad11-474a-8294-622e606f4130"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Paypal_Webhook')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Paypal_Webhook')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "df8adbc7-3840-4030-a523-ad16ec57c3cf"
                            },
                            "type": "Scope"
                        },
                        "Scope_Stripe_Webhook": {
                            "actions": {
                                "List_Callback_URL_Stripe_Webhook": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "a92b3058-3750-4d60-b93b-d4fa84226b34"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Stripe_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Stripe_Webhook": {
                                    "runAfter": {
                                        "List_Callback_URL_Stripe_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "774ab1fd-b6e9-4390-bfdb-c569a49bf46f"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Stripe_Webhook']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Stripe_Webhook": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Stripe_Webhook": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "ae03f60f-0c0d-4fa4-a553-07e145812c97"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Stripe_Webhook')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Stripe_Webhook')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "282761d7-220b-428b-8302-c3a8c60e0d8b"
                            },
                            "type": "Scope"
                        },
                        "Scope_AzureAD_Signed": {
                            "actions": {
                                "List_Callback_URL_AzureAD_Signed": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "4cfb28e7-9c8f-4ccd-a8f7-abc697e2a442"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__AzureAD_Signed']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_AzureAD_Signed": {
                                    "runAfter": {
                                        "List_Callback_URL_AzureAD_Signed": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "4ff759c2-c87a-4ebd-a585-0004f9f1c784"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__AzureAD_Signed']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_AzureAD_Signed": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_AzureAD_Signed": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "965f4adf-9e3c-497e-bda1-869e2eea05b5"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_AzureAD_Signed')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_AzureAD_Signed')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "3e70bc6e-a11c-44fb-aaea-25b83bdab2ae"
                            },
                            "type": "Scope"
                        },
                        "Scope_Microsoft_Meter": {
                            "actions": {
                                "List_Callback_URL_Microsoft_Meter": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "5457d0d6-0712-4f37-a9a4-946f11149cdf"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_flowmanagement",
                                            "operationId": "ListCallbackUrl",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_flowmanagement"
                                        },
                                        "parameters": {
                                            "environmentName": "@workflow()?['tags']?['environmentName']",
                                            "flowName": "@variables('AllFlows')?['cycle0__Microsoft_Meter']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_a_row_by_AllEnvs_http_Microsoft_Meter": {
                                    "runAfter": {
                                        "List_Callback_URL_Microsoft_Meter": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "5da0164f-2cda-4a56-b7f9-53a2ae04ad28"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "GetItem",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@variables('AllEnvs')?['new_envpar_http__Microsoft_Meter']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Update_a_row_Microsoft_Meter": {
                                    "runAfter": {
                                        "Get_a_row_by_AllEnvs_http_Microsoft_Meter": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "081eba48-53b4-4009-a6ae-97e398d92e3f"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_http_Microsoft_Meter')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@outputs('List_Callback_URL_Microsoft_Meter')?['body/response/value']"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Scope_Http_0": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "29cf91ad-9479-4538-bd88-38608d39f0e5"
                            },
                            "type": "Scope"
                        }
                    },
                    "runAfter": {
                        "Scope_Misc": [
                            "Succeeded",
                            "TimedOut",
                            "Failed",
                            "Skipped"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "f7111d1a-6c6c-46d8-bd2b-4d827e8aa59a"
                    },
                    "type": "Scope"
                },
                "Scope_Owner": {
                    "actions": {
                        "Get_a_row_by_AllEnvs_config_OwnerId": {
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "04ed566a-ba52-485b-ae38-17dd0e546108"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                                "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "GetItem",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                    "entityName": "environmentvariablevalues",
                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__OwnerId']"
                                },
                                "authentication": "@parameters('$authentication')"
                            }
                        },
                        "Condition_OwnerEmail_origin": {
                            "actions": {
                                "Set_variable_OwnerEmail_Query": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "9d285756-5bf3-4efb-8fcf-31edd764f23d"
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "OwnerEmail",
                                        "value": "@{toLower(trim(string(triggerOutputs()?['queries']?['owneremail'])))}"
                                    }
                                }
                            },
                            "runAfter": {
                                "Get_a_row_by_AllEnvs_config_OwnerEmail": [
                                    "Succeeded"
                                ]
                            },
                            "else": {
                                "actions": {
                                    "Set_variable_OwnerEmail_Env": {
                                        "runAfter": {},
                                        "metadata": {
                                            "operationMetadataId": "ccacb77f-8ca8-46d6-8d7f-311d23143d89"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                            "name": "OwnerEmail",
                                            "value": "@{toLower(trim(string(outputs('Get_a_row_by_AllEnvs_config_OwnerEmail')?['body/value'])))}"
                                        }
                                    }
                                }
                            },
                            "expression": {
                                "equals": [
                                    "@trim(string(outputs('Get_a_row_by_AllEnvs_config_OwnerEmail')?['body/value']))",
                                    ""
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "45702c27-a9d3-4244-bee6-d78b5b0acba4"
                            },
                            "type": "If"
                        },
                        "Condition_OwnerEmail": {
                            "actions": {
                                "Update_a_row_config__OwnerEmail": {
                                    "runAfter": {
                                        "Update_a_row_config__OwnerId": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "0255c431-5184-4c41-abea-8e2ca6f2dc63"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_config_OwnerEmail')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@variables('OwnerEmail')"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Condition_OwnerId": {
                                    "actions": {
                                        "Set_variable_OwnerId_Env": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "be00fae1-a072-47b3-bb11-5d5d01025543"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "OwnerId",
                                                "value": "@{outputs('Get_a_row_by_AllEnvs_config_OwnerId')?['body/value']}"
                                            }
                                        },
                                        "Set_variable_OwnerEmail_Env_2": {
                                            "runAfter": {
                                                "Set_variable_OwnerId_Env": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "87dea7f1-22b6-4900-88e4-aa181158530e"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "OwnerEmail",
                                                "value": "@{toLower(trim(string(outputs('Get_a_row_by_AllEnvs_config_OwnerEmail')?['body/value'])))}"
                                            }
                                        }
                                    },
                                    "runAfter": {},
                                    "else": {
                                        "actions": {
                                            "HTTP_Add_invitation": {
                                                "runAfter": {},
                                                "metadata": {
                                                    "operationMetadataId": "7d178bab-cffd-494e-9571-3b2e75332305"
                                                },
                                                "type": "Http",
                                                "inputs": {
                                                    "method": "POST",
                                                    "uri": "https://graph.microsoft.com/v1.0/invitations",
                                                    "headers": {
                                                        "Content-type": "application/json"
                                                    },
                                                    "body": {
                                                        "invitedUserEmailAddress": "@{variables('OwnerEmail')}",
                                                        "sendInvitationMessage": true,
                                                        "invitedUserType": "Member",
                                                        "inviteRedirectUrl": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                                        "invitedUserMessageInfo": {
                                                            "ccRecipients": [
                                                                {
                                                                    "emailAddress": {
                                                                        "name": "@{variables('AdminEmail')}",
                                                                        "address": "@{variables('AdminEmail')}"
                                                                    }
                                                                }
                                                            ],
                                                            "customizedMessageBody": "Your WorkSchool 365 BusinessUniversity (Cycle 0) has been setup automatically from the open source code at https://github.com/1337777/workschool365 . Sign-in with your email into your new site: https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1 , or Click the invite link in this message."
                                                        }
                                                    },
                                                    "authentication": {
                                                        "type": "ActiveDirectoryOAuth",
                                                        "tenant": "@parameters('envpar_config__TenantDomain')",
                                                        "audience": "https://graph.microsoft.com",
                                                        "clientId": "@variables('GraphAppId')",
                                                        "secret": "@variables('GraphAppSecret')"
                                                    },
                                                    "host": {
                                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents",
                                                        "connectionName": "shared_webcontents_1",
                                                        "operationId": "InvokeHttp"
                                                    },
                                                    "parameters": {
                                                        "request/method": "POST",
                                                        "request/url": "https://graph.microsoft.com/v1.0/invitations",
                                                        "request/headers": {
                                                            "Content-type": "application/json"
                                                        },
                                                        "request/body": "{\n  \"invitedUserEmailAddress\": \"@{variables('OwnerEmail')}\",\n  \"sendInvitationMessage\": true,\n  \"invitedUserType\": \"Member\",\n  \"inviteRedirectUrl\": \"https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1\",\n  \"invitedUserMessageInfo\": {\n     \"ccRecipients\": [\n          {\n             \"emailAddress\": {\n                 \"name\": \"@{variables('AdminEmail')}\",\n                 \"address\": \"@{variables('AdminEmail')}\"\n              }\n          }\n     ],\n     \"customizedMessageBody\": \"Your WorkSchool 365 BusinessUniversity (Cycle 0) has been setup automatically from the open source code at https://github.com/1337777/workschool365 . Sign-in with your email into your new site: https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1 , or Click the invite link in this message.\"\n  }\n}"
                                                    }
                                                }
                                            },
                                            "Set_variable_OwnerId": {
                                                "runAfter": {
                                                    "HTTP_Add_invitation": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "metadata": {
                                                    "operationMetadataId": "f7596fe9-7b27-47bc-bc95-ee77785a2c07"
                                                },
                                                "type": "SetVariable",
                                                "inputs": {
                                                    "name": "OwnerId",
                                                    "value": "@{body('HTTP_Add_invitation')?['invitedUser']?['id']}"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "not": {
                                            "equals": [
                                                "@trim(string(outputs('Get_a_row_by_AllEnvs_config_OwnerId')?['body/value']))",
                                                "@''"
                                            ]
                                        }
                                    },
                                    "metadata": {
                                        "operationMetadataId": "f0ed0952-6628-4bc3-94eb-3452515fa482"
                                    },
                                    "type": "If"
                                },
                                "Update_a_row_config__OwnerId": {
                                    "runAfter": {
                                        "HTTP_Add_roles_3": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "dd0c8eee-0115-4517-85cf-8d346bd2542e"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_commondataserviceforapps",
                                            "operationId": "UpdateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                            "entityName": "environmentvariablevalues",
                                            "recordId": "@outputs('Get_a_row_by_AllEnvs_config_OwnerId')?['body']?['environmentvariablevalueid']",
                                            "item/value": "@variables('OwnerId')"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Delay_1min": {
                                    "runAfter": {
                                        "Condition_OwnerId": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "c1d05749-8891-48f1-94d4-cdb9d40687fe"
                                    },
                                    "type": "Wait",
                                    "inputs": {
                                        "interval": {
                                            "count": 1,
                                            "unit": "Minute"
                                        }
                                    }
                                },
                                "HTTP_Add_roles": {
                                    "runAfter": {
                                        "Delay_1min": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "6a7d0729-a7e4-45d5-a7c6-2e481075991b"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "POST",
                                        "uri": "https://graph.microsoft.com/v1.0/$batch",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "requests": [
                                                {
                                                    "id": "1",
                                                    "url": "/directoryRoles/roleTemplateId=0526716b-113d-4c15-b2c8-68e3c22b9f80/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "2",
                                                    "url": "/directoryRoles/roleTemplateId=0964bb5e-9bdb-4d7b-ac29-58e794862a40/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "3",
                                                    "url": "/directoryRoles/roleTemplateId=0f971eea-41eb-4569-a71e-57bb8a3eff1e/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "4",
                                                    "url": "/directoryRoles/roleTemplateId=11648597-926c-4cf3-9c36-bcebb0ba8dcc/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "5",
                                                    "url": "/directoryRoles/roleTemplateId=158c047a-c907-4556-b7ef-446551a6b5f7/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "6",
                                                    "url": "/directoryRoles/roleTemplateId=17315797-102d-40b4-93e0-432062caca18/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "7",
                                                    "url": "/directoryRoles/roleTemplateId=194ae4cb-b126-40b2-bd5b-6091b380977d/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "8",
                                                    "url": "/directoryRoles/roleTemplateId=29232cdf-9323-42fd-ade2-1d097af3e4de/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "9",
                                                    "url": "/directoryRoles/roleTemplateId=2b745bdf-0803-4d80-aa65-822c4493daac/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "10",
                                                    "url": "/directoryRoles/roleTemplateId=31392ffb-586c-42d1-9346-e59415a2cc4e/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "11",
                                                    "url": "/directoryRoles/roleTemplateId=38a96431-2bdf-4b4c-8b6e-5d3d8abac1a4/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "12",
                                                    "url": "/directoryRoles/roleTemplateId=3a2c62db-5318-420d-8d74-23affee5d9d5/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "13",
                                                    "url": "/directoryRoles/roleTemplateId=3d762c5a-1b6c-493f-843e-55a3b42923d4/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "14",
                                                    "url": "/directoryRoles/roleTemplateId=3edaf663-341e-4475-9f94-5c398ef6c070/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "15",
                                                    "url": "/directoryRoles/roleTemplateId=44367163-eba1-44c3-98af-f5787879f96a/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "16",
                                                    "url": "/directoryRoles/roleTemplateId=45d8d3c5-c802-45c6-b32a-1d70b5e1e86e/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "17",
                                                    "url": "/directoryRoles/roleTemplateId=4d6ac14f-3453-41d0-bef9-a3e0c569773a/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "18",
                                                    "url": "/directoryRoles/roleTemplateId=644ef478-e28f-4e28-b9dc-3fdde9aa0b1f/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "19",
                                                    "url": "/directoryRoles/roleTemplateId=69091246-20e8-4a56-aa4d-066075b2a7a8/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                }
                                            ]
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        }
                                    }
                                },
                                "HTTP_Add_roles_2": {
                                    "runAfter": {
                                        "HTTP_Add_roles": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "2483dc56-53ba-4ef6-879a-5480f1406a25"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "POST",
                                        "uri": "https://graph.microsoft.com/v1.0/$batch",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "requests": [
                                                {
                                                    "id": "20",
                                                    "url": "/directoryRoles/roleTemplateId=6e591065-9bad-43ed-90f3-e9424366d2f0/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "21",
                                                    "url": "/directoryRoles/roleTemplateId=729827e3-9c14-49f7-bb1b-9608f156bbb8/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "22",
                                                    "url": "/directoryRoles/roleTemplateId=7495fdc4-34c4-4d15-a289-98788ce399fd/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "23",
                                                    "url": "/directoryRoles/roleTemplateId=74ef975b-6605-40af-a5d2-b9539d836353/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "24",
                                                    "url": "/directoryRoles/roleTemplateId=75941009-915a-4869-abe7-691bff18279e/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "25",
                                                    "url": "/directoryRoles/roleTemplateId=7698a772-787b-4ac8-901f-60d6b08affd2/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "26",
                                                    "url": "/directoryRoles/roleTemplateId=7be44c8a-adaf-4e2a-84d6-ab2649e08a13/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "27",
                                                    "url": "/directoryRoles/roleTemplateId=8329153b-31d0-4727-b945-745eb3bc5f31/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "28",
                                                    "url": "/directoryRoles/roleTemplateId=8ac3fc64-6eca-42ea-9e69-59f4c7b60eb2/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "29",
                                                    "url": "/directoryRoles/roleTemplateId=966707d0-3269-4727-9be2-8c3a10f19b9d/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "30",
                                                    "url": "/directoryRoles/roleTemplateId=9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "31",
                                                    "url": "/directoryRoles/roleTemplateId=9c6df0f2-1e7c-4dc3-b195-66dfbd24aa8f/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "32",
                                                    "url": "/directoryRoles/roleTemplateId=9f06204d-73c1-4d4c-880a-6edb90606fd8/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "33",
                                                    "url": "/directoryRoles/roleTemplateId=a9ea8996-122f-4c74-9520-8edcd192826c/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "34",
                                                    "url": "/directoryRoles/roleTemplateId=aaf43236-0c0d-4d5f-883a-6955382ac081/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "35",
                                                    "url": "/directoryRoles/roleTemplateId=b0f54661-2d74-4c50-afa3-1ec803f12efe/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "36",
                                                    "url": "/directoryRoles/roleTemplateId=b1be1c3e-b65d-4f19-8427-f6fa0d97feb9/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "37",
                                                    "url": "/directoryRoles/roleTemplateId=b5a8dcf3-09d5-43a9-a639-8e29ef291470/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "38",
                                                    "url": "/directoryRoles/roleTemplateId=baf37b3a-610e-45da-9e62-d9d1e5e8914b/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "39",
                                                    "url": "/directoryRoles/roleTemplateId=be2f45a1-457d-42af-a067-6ec1fa63bc45/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                }
                                            ]
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        }
                                    }
                                },
                                "HTTP_Add_roles_3": {
                                    "runAfter": {
                                        "HTTP_Add_roles_2": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "d7192fa8-f30f-4ac6-bb45-6592252cee74"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                        "method": "POST",
                                        "uri": "https://graph.microsoft.com/v1.0/$batch",
                                        "headers": {
                                            "Content-type": "application/json"
                                        },
                                        "body": {
                                            "requests": [
                                                {
                                                    "id": "40",
                                                    "url": "/directoryRoles/roleTemplateId=c430b396-e693-46cc-96f3-db01bf8bb62a/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "41",
                                                    "url": "/directoryRoles/roleTemplateId=c4e39bd9-1100-46d3-8c65-fb160da0071f/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "42",
                                                    "url": "/directoryRoles/roleTemplateId=d37c8bed-0711-4417-ba38-b4abe66ce4c2/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "43",
                                                    "url": "/directoryRoles/roleTemplateId=e3973bdf-4987-49ae-837a-ba8e231c7286/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "44",
                                                    "url": "/directoryRoles/roleTemplateId=e6d1a23a-da11-4be4-9570-befc86d067a7/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "45",
                                                    "url": "/directoryRoles/roleTemplateId=e8611ab8-c189-46e8-94e1-60213ab1f814/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "46",
                                                    "url": "/directoryRoles/roleTemplateId=eb1f4a8d-243a-41f0-9fbd-c7cdf6c5ef7c/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "47",
                                                    "url": "/directoryRoles/roleTemplateId=f023fd81-a637-4b56-95fd-791ac0226033/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "48",
                                                    "url": "/directoryRoles/roleTemplateId=f28a1f50-f6e7-4571-818b-6a12f2af6b6c/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "49",
                                                    "url": "/directoryRoles/roleTemplateId=f2ef992c-3afb-46b9-b7cf-a126ee74c451/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "50",
                                                    "url": "/directoryRoles/roleTemplateId=fdd7a751-b60b-444a-984c-02652fe8fa1c/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                },
                                                {
                                                    "id": "51",
                                                    "url": "/directoryRoles/roleTemplateId=fe930be7-5e62-47db-91af-98c3a49a38b1/members/$ref",
                                                    "method": "POST",
                                                    "headers": {
                                                        "Content-Type": "application/json"
                                                    },
                                                    "body": {
                                                        "@@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/@{variables('OwnerId')}"
                                                    }
                                                }
                                            ]
                                        },
                                        "authentication": {
                                            "type": "ActiveDirectoryOAuth",
                                            "tenant": "@parameters('envpar_config__TenantDomain')",
                                            "audience": "https://graph.microsoft.com",
                                            "clientId": "@variables('GraphAppId')",
                                            "secret": "@variables('GraphAppSecret')"
                                        }
                                    }
                                }
                            },
                            "runAfter": {
                                "Condition_OwnerEmail_origin": [
                                    "Succeeded"
                                ]
                            },
                            "expression": {
                                "or": [
                                    {
                                        "not": {
                                            "equals": [
                                                "@variables('OwnerEmail')",
                                                ""
                                            ]
                                        }
                                    },
                                    {
                                        "not": {
                                            "equals": [
                                                "@trim(string(outputs('Get_a_row_by_AllEnvs_config_OwnerId')?['body/value']))",
                                                ""
                                            ]
                                        }
                                    }
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "0ecbdc79-5495-4dd3-b5fe-4fc3a5a0d846"
                            },
                            "type": "If"
                        },
                        "Get_a_row_by_AllEnvs_config_OwnerEmail": {
                            "runAfter": {
                                "Get_a_row_by_AllEnvs_config_OwnerId": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "b46d2427-1f40-49af-8896-2c47720133d9"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                                "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "GetItem",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                    "entityName": "environmentvariablevalues",
                                    "recordId": "@variables('AllEnvs')?['new_envpar_config__OwnerEmail']"
                                },
                                "authentication": "@parameters('$authentication')"
                            }
                        }
                    },
                    "runAfter": {
                        "Scope_Http": [
                            "Succeeded",
                            "Failed",
                            "Skipped",
                            "TimedOut"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "9b9a81d0-c884-4a48-9129-2e09a2a9ba73"
                    },
                    "type": "Scope"
                },
                "Initialize_variable_OwnerEmail": {
                    "runAfter": {
                        "Initialize_variable_AdminId": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "b09a0b87-2a8d-4c41-ae18-9b3dc1f29d03"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "OwnerEmail",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Initialize_variable_varCounter1": {
                    "runAfter": {
                        "Initialize_variable_OwnerId": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "fb9cf65e-f146-4b9c-87e8-e1f469b08967"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "varCounter1",
                                "type": "integer"
                            }
                        ]
                    }
                },
                "Initialize_variable_OwnerId": {
                    "runAfter": {
                        "Initialize_variable_OwnerEmail": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "ad82d7ea-769a-4777-b1f3-b32d2003d14d"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "OwnerId",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Scope_Cycles": {
                    "actions": {
                        "Condition_OwnerId_OwnerEmail": {
                            "actions": {
                                "Do_until_Cycles": {
                                    "actions": {
                                        "Run_a_Child_Flow_Cycle2": {
                                            "runAfter": {},
                                            "metadata": {
                                                "operationMetadataId": "c4a87f07-0db3-4586-8860-e51700158557"
                                            },
                                            "type": "Workflow",
                                            "inputs": {
                                                "host": {
                                                    "workflowReferenceName": "ead81545-25db-ea11-a815-000d3af42a37"
                                                },
                                                "body": {
                                                    "TenantDomain": "@parameters('envpar_config__TenantDomain')",
                                                    "CycleGroupName": "@{parameters('envpar_config__CyclesRename')}@{add(variables('varCounter1'), 2)}",
                                                    "CycleGroupOwnerId": "@variables('OwnerId')",
                                                    "Cycle1GroupName": "@{parameters('envpar_config__CyclesRename')}1",
                                                    "IsCycle1": false
                                                }
                                            }
                                        },
                                        "Increment_variable_varCounter1": {
                                            "runAfter": {
                                                "Scope_Cycle0_CycleN": [
                                                    "Succeeded",
                                                    "Failed"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "91c48e6f-e7d9-4a0d-9844-c5b29d73774c"
                                            },
                                            "type": "IncrementVariable",
                                            "inputs": {
                                                "name": "varCounter1",
                                                "value": 1
                                            }
                                        },
                                        "Scope_Cycle0_CycleN": {
                                            "actions": {
                                                "HTTP_Cycle0_Add_CycleN_Users": {
                                                    "runAfter": {},
                                                    "metadata": {
                                                        "operationMetadataId": "f4ff00fc-2fc9-450c-b207-ace9dfecdadf"
                                                    },
                                                    "type": "OpenApiConnection",
                                                    "inputs": {
                                                        "host": {
                                                            "connectionName": "shared_sharepointonline",
                                                            "operationId": "HttpRequest",
                                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                                        },
                                                        "parameters": {
                                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CycleZeroName')}",
                                                            "parameters/method": "POST",
                                                            "parameters/uri": "/_api/web/siteusers",
                                                            "parameters/headers": {
                                                                "content-type": "application/json; odata=verbose"
                                                            },
                                                            "parameters/body": "{ '__metadata': { 'type': 'SP.User' }, 'LoginName':'c:0o.c|federateddirectoryclaimprovider|@{outputs('Run_a_Child_Flow_Cycle2')?['Body']?['CycleGroupId']}' }"
                                                        },
                                                        "authentication": "@parameters('$authentication')"
                                                    }
                                                },
                                                "HTTP_Cycle0_MyGroups_Contribute_from_CycleN_Users": {
                                                    "runAfter": {
                                                        "HTTP_Cycle0_Add_CycleN_Users": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "metadata": {
                                                        "operationMetadataId": "2e30d724-fcbd-429a-9fe5-2bec54d263bd"
                                                    },
                                                    "type": "OpenApiConnection",
                                                    "inputs": {
                                                        "host": {
                                                            "connectionName": "shared_sharepointonline",
                                                            "operationId": "HttpRequest",
                                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                                        },
                                                        "parameters": {
                                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CycleZeroName')}",
                                                            "parameters/method": "POST",
                                                            "parameters/uri": "_api/web/lists/getByTitle('MyGroups')/roleassignments/addroleassignment(principalid=@{body('HTTP_Cycle0_Add_CycleN_Users')?['d']?['Id']},roleDefId=1073741827)",
                                                            "parameters/headers": {
                                                                "content-type": "application/json; odata=verbose"
                                                            }
                                                        },
                                                        "authentication": "@parameters('$authentication')"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Run_a_Child_Flow_Cycle2": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "metadata": {
                                                "operationMetadataId": "3dcf8107-48f6-4b99-b486-24e97e8ee681"
                                            },
                                            "type": "Scope"
                                        }
                                    },
                                    "runAfter": {
                                        "HTTP_Cycle0_MyGroups_Break_Inheritance": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "expression": "@equals(variables('varCounter1'), sub(int(parameters('envpar_config__CyclesNumber')), 1))",
                                    "limit": {
                                        "count": 60,
                                        "timeout": "PT1H"
                                    },
                                    "metadata": {
                                        "operationMetadataId": "0e429051-217b-4692-9599-ff50b5e536d0"
                                    },
                                    "type": "Until"
                                },
                                "HTTP_Cycle0_MyGroups_Break_Inheritance": {
                                    "runAfter": {
                                        "Create_sharing_link_for_a_file_or_folder_EventReview": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "a13e8f53-f3a1-4302-b31d-115d379c7800"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline",
                                            "operationId": "HttpRequest",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CycleZeroName')}",
                                            "parameters/method": "POST",
                                            "parameters/uri": "_api/web/lists/getByTitle('MyGroups')/breakroleinheritance(copyRoleAssignments=true, clearSubscopes=true)",
                                            "parameters/headers": {
                                                "content-type": "application/json; odata=verbose"
                                            }
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Create_sharing_link_for_a_file_or_folder_SurveyQuiz": {
                                    "runAfter": {
                                        "Set_content_approval_status_SurveyQuiz_Approve": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "0cf07c8a-0add-4f25-8bc8-bfc284fa57da"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline",
                                            "operationId": "CreateSharingLink",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "SurveyQuiz",
                                            "id": "@outputs('Get_file_metadata_using_path_SurveyQuiz')?['body/ItemId']",
                                            "permission/type": "view",
                                            "permission/scope": "anonymous"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_file_metadata_using_path_SurveyQuiz": {
                                    "runAfter": {
                                        "Run_a_Child_Flow_Cycle1": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "8f7db2e6-148a-438d-978c-5debae2bb12f"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline",
                                            "operationId": "GetFileMetadataByPath",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "path": "@'/SurveyQuiz/General/General__QUIZ001.docx'"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Get_file_metadata_using_path_EventReview": {
                                    "runAfter": {
                                        "Create_sharing_link_for_a_file_or_folder_SurveyQuiz": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "121b3a6a-c626-4f83-bf1f-e380cbfbaf0d"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline",
                                            "operationId": "GetFileMetadataByPath",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "path": "@'/EventReview/Receipts/EventReview.xlsx'"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Create_sharing_link_for_a_file_or_folder_EventReview": {
                                    "runAfter": {
                                        "Set_content_approval_status_EventReview_Approve": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "711a0238-9e97-4bd3-914c-976ed2f46d3c"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline",
                                            "operationId": "CreateSharingLink",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "EventReview",
                                            "id": "@outputs('Get_file_metadata_using_path_EventReview')?['body/ItemId']",
                                            "permission/type": "view",
                                            "permission/scope": "anonymous"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Set_content_approval_status_SurveyQuiz_Submit": {
                                    "runAfter": {
                                        "Get_file_metadata_using_path_SurveyQuiz": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "6abade08-8755-4a99-ae03-48571c1b2f46"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline_1",
                                            "operationId": "SetApprovalStatus",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "SurveyQuiz",
                                            "id": "@outputs('Get_file_metadata_using_path_SurveyQuiz')?['body/ItemId']",
                                            "approvalAction": "Submit",
                                            "comments": "",
                                            "entityTag": "@outputs('Get_file_metadata_using_path_SurveyQuiz')?['body/ETag']"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Set_content_approval_status_SurveyQuiz_Approve": {
                                    "runAfter": {
                                        "Set_content_approval_status_SurveyQuiz_Submit": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "5e2c0a1c-6e12-4872-9a8b-d2eb464d7729"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline_1",
                                            "operationId": "SetApprovalStatus",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "SurveyQuiz",
                                            "id": "@outputs('Get_file_metadata_using_path_SurveyQuiz')?['body/ItemId']",
                                            "approvalAction": "Approve",
                                            "comments": "",
                                            "entityTag": "@outputs('Set_content_approval_status_SurveyQuiz_Submit')?['body/ETag']"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Set_content_approval_status_EventReview_Submit": {
                                    "runAfter": {
                                        "Get_file_metadata_using_path_EventReview": [
                                            "Succeeded"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "b6d5185e-ab44-4112-b9b0-45252c3fcd3f"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline_1",
                                            "operationId": "SetApprovalStatus",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "EventReview",
                                            "id": "@outputs('Get_file_metadata_using_path_EventReview')?['body/ItemId']",
                                            "approvalAction": "Submit",
                                            "comments": "",
                                            "entityTag": "@outputs('Get_file_metadata_using_path_EventReview')?['body/ETag']"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Set_content_approval_status_EventReview_Approve": {
                                    "runAfter": {
                                        "Set_content_approval_status_EventReview_Submit": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "1b12d56b-4d0f-4059-a79d-3198acc0c306"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_sharepointonline_1",
                                            "operationId": "SetApprovalStatus",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
                                        },
                                        "parameters": {
                                            "dataset": "https://@{parameters('envpar_config__TenantName')}.sharepoint.com/sites/@{parameters('envpar_config__CyclesRename')}1",
                                            "table": "EventReview",
                                            "id": "@outputs('Get_file_metadata_using_path_EventReview')?['body/ItemId']",
                                            "approvalAction": "Approve",
                                            "comments": "",
                                            "entityTag": "@outputs('Set_content_approval_status_EventReview_Submit')?['body/ETag']"
                                        },
                                        "authentication": "@parameters('$authentication')",
                                        "retryPolicy": {
                                            "type": "none"
                                        }
                                    }
                                },
                                "Run_a_Child_Flow_Cycle1": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "b9a2e04e-fc05-42c9-84e7-772204f382df"
                                    },
                                    "type": "Workflow",
                                    "inputs": {
                                        "host": {
                                            "workflowReferenceName": "ead81545-25db-ea11-a815-000d3af42a37"
                                        },
                                        "body": {
                                            "TenantDomain": "@parameters('envpar_config__TenantDomain')",
                                            "CycleGroupName": "@{parameters('envpar_config__CyclesRename')}1",
                                            "CycleGroupOwnerId": "@variables('OwnerId')",
                                            "Cycle1GroupName": "@{parameters('envpar_config__CyclesRename')}1",
                                            "IsCycle1": true
                                        }
                                    }
                                }
                            },
                            "runAfter": {},
                            "expression": {
                                "and": [
                                    {
                                        "not": {
                                            "equals": [
                                                "@variables('OwnerId')",
                                                ""
                                            ]
                                        }
                                    },
                                    {
                                        "not": {
                                            "equals": [
                                                "@variables('OwnerEmail')",
                                                ""
                                            ]
                                        }
                                    }
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "cb2d2da2-9650-4766-8f1f-eed4d019c551"
                            },
                            "type": "If"
                        }
                    },
                    "runAfter": {
                        "Scope_TurnOnOff": [
                            "Succeeded",
                            "Failed"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "8d8be4d9-f026-4496-b40a-4607c53d704a"
                    },
                    "type": "Scope"
                },
                "Scope_TurnOnOff": {
                    "actions": {
                        "Compose_TurnOnOff": {
                            "runAfter": {},
                            "metadata": {
                                "operationMetadataId": "3dacc6da-1752-4b0d-a962-a9f66aea7bcf"
                            },
                            "type": "Compose",
                            "inputs": [
                                "cycle0__AzureAD_Signed",
                                "cycle0__Sharepoint_Copy_List",
                                "cycle0__GroupsList",
                                "cycle0__Setup",
                                "cycle0__ParseWordDocument",
                                "cycle0__ParseWordEventReview",
                                "cycle0__SurveyQuiz",
                                "cycle0__EventReview",
                                "cycle0__EventReview__Delete",
                                "cycle0__MySubscriptions",
                                "cycle0__Stripe_Webhook",
                                "cycle0__Paypal_Webhook",
                                "cycle0__Microsoft_Contact_Webhook",
                                "cycle0__Microsoft_Create_Webhook",
                                "cycle0__Microsoft_Update_Webhook",
                                "cycle0__Microsoft_Meter",
                                "cycle0__Flow_TriggerUri",
                                "cycle0__MyGroups",
                                "cycle0__Form_Email",
                                "cycle0__Graph_Notifications_Interface",
                                "cycle0__Graph_Users_Webhook",
                                "cycle0__Graph_Groups_Webhook"
                            ]
                        },
                        "Apply_to_each_TurnOnOff": {
                            "foreach": "@outputs('Compose_TurnOnOff')",
                            "actions": {
                                "Disable_Flow_as_Admin_TurnOnOff": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "8691a95c-6339-46e5-8020-a8b277072572"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_microsoftflowforadmins",
                                            "operationId": "Disable-AdminFlow",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_microsoftflowforadmins"
                                        },
                                        "parameters": {
                                            "environment": "@workflow()?['tags']?['environmentName']",
                                            "flow": "@variables('AllFlows')?[item()]",
                                            "api-version": "2016-11-01"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Enable_Flow_as_Admin_TurnOnOff": {
                                    "runAfter": {
                                        "Disable_Flow_as_Admin_TurnOnOff": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "66591800-eba1-4fa8-9785-5921e665527f"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_microsoftflowforadmins",
                                            "operationId": "Enable-AdminFlow",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_microsoftflowforadmins"
                                        },
                                        "parameters": {
                                            "environment": "@workflow()?['tags']?['environmentName']",
                                            "flow": "@variables('AllFlows')?[item()]",
                                            "api-version": "2016-11-01"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Compose_TurnOnOff": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "7ebd052a-1b16-40a9-b80b-b59e6e439479"
                            },
                            "type": "Foreach"
                        },
                        "Compose_TurnOnOff_Template": {
                            "runAfter": {
                                "Apply_to_each_TurnOnOff": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "cd005205-079c-41a5-8b4b-b83cc34c5b98"
                            },
                            "type": "Compose",
                            "inputs": [
                                "cycle0__SurveyQuiz__Template",
                                "cycle0__EventReview__Template",
                                "cycle0__EventReview__Delete__Template",
                                "cycle0__MySubscriptions__Template",
                                "cycle0__Stripe_Webhook__Template",
                                "cycle0__Paypal_Webhook__Template",
                                "cycle0__Microsoft_Contact_Webhook__Template",
                                "cycle0__Microsoft_Create_Webhook__Template",
                                "cycle0__Microsoft_Update_Webhook__Template",
                                "cycle0__Microsoft_Meter__Template"
                            ]
                        },
                        "Apply_to_each_TurnOnOff_Template": {
                            "foreach": "@outputs('Compose_TurnOnOff_Template')",
                            "actions": {
                                "Disable_Flow_as_Admin_TurnOnOff_Template": {
                                    "runAfter": {},
                                    "metadata": {
                                        "operationMetadataId": "29ebf31c-231c-4869-bd56-ee768a9028f8"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_microsoftflowforadmins",
                                            "operationId": "Disable-AdminFlow",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_microsoftflowforadmins"
                                        },
                                        "parameters": {
                                            "environment": "@workflow()?['tags']?['environmentName']",
                                            "flow": "@variables('AllFlows')?[item()]",
                                            "api-version": "2016-11-01"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                },
                                "Enable_Flow_as_Admin_TurnOnOff_Template": {
                                    "runAfter": {
                                        "Disable_Flow_as_Admin_TurnOnOff_Template": [
                                            "Succeeded",
                                            "Failed"
                                        ]
                                    },
                                    "metadata": {
                                        "operationMetadataId": "13b17147-ee95-4e75-92f8-0b67688a30ac"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connectionName": "shared_microsoftflowforadmins",
                                            "operationId": "Enable-AdminFlow",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_microsoftflowforadmins"
                                        },
                                        "parameters": {
                                            "environment": "@workflow()?['tags']?['environmentName']",
                                            "flow": "@variables('AllFlows')?[item()]",
                                            "api-version": "2016-11-01"
                                        },
                                        "authentication": "@parameters('$authentication')"
                                    }
                                }
                            },
                            "runAfter": {
                                "Compose_TurnOnOff_Template": [
                                    "Succeeded"
                                ]
                            },
                            "metadata": {
                                "operationMetadataId": "6c3b9382-9a2b-4b31-871a-42d0d8f1092a"
                            },
                            "type": "Foreach"
                        }
                    },
                    "runAfter": {
                        "Scope_Owner": [
                            "Succeeded",
                            "Failed",
                            "Skipped",
                            "TimedOut"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "f7b88566-7663-4c62-a6eb-94c6f9f22c42"
                    },
                    "type": "Scope"
                },
                "Initialize_variable_AdminEmail": {
                    "runAfter": {
                        "Initialize_variable_GraphAppSecret": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "e638b8b6-eae2-4804-b324-80f35add1d96"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "AdminEmail",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Initialize_variable_AdminId": {
                    "runAfter": {
                        "Initialize_variable_AdminEmail": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "130b70c5-c80e-485c-a409-ec15a6c2bbce"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "AdminId",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Initialize_variable_GraphAppId": {
                    "runAfter": {
                        "Initialize_variable_LoginAppId": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "779a8c95-a444-4025-a189-3f9001a65018"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "GraphAppId",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Initialize_variable_GraphAppSecret": {
                    "runAfter": {
                        "Initialize_variable_GraphAppId": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "598d147b-6803-4ded-af48-8770cf8dda03"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "GraphAppSecret",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Condition_callback": {
                    "actions": {},
                    "runAfter": {
                        "Scope_Cycles": [
                            "Succeeded",
                            "Failed",
                            "Skipped",
                            "TimedOut"
                        ]
                    },
                    "else": {
                        "actions": {
                            "HTTP_Callback": {
                                "runAfter": {
                                    "Compose_signInUrl": [
                                        "Succeeded"
                                    ]
                                },
                                "metadata": {
                                    "operationMetadataId": "8817c001-ba26-42fd-a9aa-ad7ecde74eba"
                                },
                                "type": "Http",
                                "inputs": {
                                    "method": "POST",
                                    "uri": "@{string(triggerOutputs()?['queries']?['callback'])}",
                                    "headers": {
                                        "Content-type": "application/json"
                                    },
                                    "body": {
                                        "SignInUrl": "@{outputs('Compose_signInUrl')}",
                                        "SurveyQuizUrl": "@{outputs('Create_sharing_link_for_a_file_or_folder_SurveyQuiz')?['body/link/webUrl']}",
                                        "EventReviewUrl": "@{outputs('Create_sharing_link_for_a_file_or_folder_EventReview')?['body/link/webUrl']}",
                                        "results": "@result('Scope_Cycles')"
                                    }
                                }
                            },
                            "Compose_signInUrl": {
                                "runAfter": {},
                                "metadata": {
                                    "operationMetadataId": "78d9fe3d-2911-49c6-b274-3d58b9bb63e1"
                                },
                                "type": "Compose",
                                "inputs": "https://login.microsoftonline.com/@{parameters('envpar_config__TenantDomain')}/oauth2/v2.0/authorize?client_id=@{variables('LoginAppId')}&response_mode=query&response_type=code&scope=https%3A%2F%2Fgraph.microsoft.com%2Fuser.read&state=%2Fsign"
                            }
                        }
                    },
                    "expression": {
                        "equals": [
                            "@string(triggerOutputs()?['queries']?['callback'])",
                            ""
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "83aaf3b8-c9d5-4fb9-84ac-4a7a31e63f9c"
                    },
                    "type": "If"
                },
                "Initialize_variable_LoginAppId": {
                    "runAfter": {
                        "Initialize_variable_AllEnvs": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "d7696c68-1a78-4445-8a07-5a4a9f3a47f5"
                    },
                    "type": "InitializeVariable",
                    "inputs": {
                        "variables": [
                            {
                                "name": "LoginAppId",
                                "type": "string"
                            }
                        ]
                    }
                },
                "Output_signInUrl": {
                    "runAfter": {
                        "Condition_callback": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "97b2ef2b-dc96-49b6-b5dd-cc8aa7ab79a2"
                    },
                    "type": "Compose",
                    "inputs": "https://login.microsoftonline.com/@{parameters('envpar_config__TenantDomain')}/oauth2/v2.0/authorize?client_id=@{variables('LoginAppId')}&response_mode=query&response_type=code&scope=https%3A%2F%2Fgraph.microsoft.com%2Fuser.read&state=%2Fsign"
                },
                "Output_SignUpEmailForm": {
                    "runAfter": {
                        "Output_signInUrl": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "5679de6a-986a-4a05-9117-61ee7e21e2e1"
                    },
                    "type": "Compose",
                    "inputs": "<form method=\"GET\" action=\"URL PATH PREFIX OF ENVIRONMENT VAR envpar_http__AzureAD_Signed\"><input name=\"api-version\" type=\"hidden\" value=\"2016-06-01\"/><input name=\"sp\" type=\"hidden\" value=\"/triggers/manual/run\"/><input name=\"sv\" type=\"hidden\" value=\"1.0\"/><input name=\"sig\" type=\"hidden\" value=\"URL QUERY SIGNATURE OF ENVIRONMENT VAR envpar_http__AzureAD_Signed\"/><input name=\"state\" type=\"hidden\" value=\"/sign_up_email\"/><input name=\"email\"/> <input type=\"submit\"/></form>"
                },
                "SETUP_MANUAL": {
                    "runAfter": {
                        "Initialize_variable_varCounter1": [
                            "Succeeded"
                        ]
                    },
                    "metadata": {
                        "operationMetadataId": "18cb8207-404f-4bce-bc8e-57ab8f44e846"
                    },
                    "type": "Compose",
                    "inputs": "WorkSchool 365 CRM & LMS for SharePoint Teams\n\nOpen Source Code Auditable\n\nhttp://github.com/1337777/workschool365\n\nMicrosoft Marketplace\n\nhttps://appsource.microsoft.com/en-us/product/web-apps/anthroplogicworkschool3651593890930054.anthroplogic_workschool_365\n\n\n1. Create Tenant Organization with Sharepoint free, Microsoft Teams free, Microsoft Power Automate free, and Microsoft Stream free /!\\\n\n2. In Sharepoint Admin, create new site (with name cycle0) only from the Sharepoint template file ws365_template_zero.wsp . \n\n3. In Power Automate, sign-out sign-in as admin (admin@orgname.onmicrosoft.com). In My flows, create sample test flow with premium HTTP action to start free trial. In Solutions, create Microsoft Dataverse (Common Data Service) database, while In Environment settings, add current user as Admin user, \n\n4. The exported Power Automate solution file is workschool365_solution.zip, ( where all \"defaultValue\":\".+?\",\"type\": has been erased with \"defaultValue\":\"\",\"type\": , and in customizations.xml , cycle0__Graph_Notifications_Interface is listed before cycle0__Graph_Users_Webhook and cycle0__Graph_Groups_Webhook )\n\n5. In Power Automate, import this solution file into Power Automate, enter the required configuration environment variables envpar_config__TenantName (orgname) and envpar_config__TenantDomain (orgname.onmicrosoft.com). And for the others configuration simply enter the space character ( ) as value, these will be filled automatically.\n\n6. In Power Automate, In the importer Solutions, Turn on these flows in this dependent sequence: starting with cycle0__Sharepoint_Copy_List then cycle0__GroupsList then cycle0__Setup. Then do the 1st run of the flow cycle0__Setup by copying its HTTP trigger url address in any web browser. Wait for this run to finish.\n\n7. In Azure Portal, in App Registrations, give admin consents to the three generated Service Principals apps: WorkSchool 365 Graph App__cycle0, WorkSchool 365 Sign App__cycle0 and WorkSchool 365 Microsoft App__cycle0 .\n\n8. In Power Automate, wait 15 minutes, do the 2nd run of the flow cycle0__Setup by copying its HTTP trigger url address in any web browser. Wait for this run to finish.\n\n9. In Azure Portal, in External Identities, in User flows, associate the generated Self-service Sign-up User Flow B1X_1_WorkSchool365__cycle0 to the service principal app WorkSchool 365 Sign App__cycle0 .\n\n10. In Power Automate, for each of these template flows, while they have turned On status, click Edit to open the code then Save again without modifying anything : cycle0__SurveyQuiz__Template , cycle0__Microsoft_Update_Webhook__Template , cycle0__Microsoft_Create_Webhook__Template , cycle0__EventReview__Template , cycle0__Paypal_Webhook__Template , cycle0__EventReview__Delete__Template , cycle0__Stripe_Webhook__Template , cycle0__MySubscriptions__Template , cycle0__Microsoft_Contact_Webhook__Template .\n\n11. In Power Automate, setup the owner email to generate its Sharepoint sites cycle1, cycle2, cycle3 in either of two ways: \n  (A) set the value of the environment variable envpar_config__OwnerEmail (owneruser@extdomain) , then do the 3rd run of the flow cycle0__Setup by copying its HTTP trigger url address in any web browser; or alternatively \n  (B) do the 3rd run of the flow cycle0__Setup but now append the query string  &owneremail=owneruser@extdomain  at the end of its trigger url address.\n\n12. Test that all the templated sites and templated flows are generated and that no setup flow did fail. (X. In Azure Portal or Graph Explorer, set admin@orgname.onmicrosoft.com user as external B2B using alternate email.) (XX. In Azure Portal, in Properties, turn off Security Defaults.)\n"
                }
            },
            "outputs": {}
        }
    },
    "schemaVersion": "1.0.0.0"
}