{
    "properties": {
        "connectionReferences": {
            "shared_sharepointonline": {
                "runtimeSource": "embedded",
                "connection": {
                    "connectionReferenceLogicalName": "new_sharedsharepointonline_9ad14"
                },
                "api": {
                    "name": "shared_sharepointonline"
                }
            }
        },
        "definition": {
            "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
            "contentVersion": "1.0.0.0",
            "parameters": {
                "$connections": {
                    "defaultValue": {},
                    "type": "Object"
                },
                "$authentication": {
                    "defaultValue": {},
                    "type": "SecureObject"
                },
                "envpar_http__SurveyQuiz": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_http__SurveyQuiz",
                        "description": "This flow HTTP trigger URL. Enter space character ( ) for none. Filled automatically."
                    }
                },
                "envpar_config__TenantName": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__TenantName",
                        "description": "Required. Org Name orgname (this is the prefix of the auto assigned domain orgname.onmicrosoft.com)"
                    }
                },
                "envpar_config__CycleZeroName": {
                    "defaultValue": "",
                    "type": "String",
                    "metadata": {
                        "schemaName": "new_envpar_config__CycleZeroName",
                        "description": "Required. Could have many environments N each with its envN_cycle0 template"
                    }
                }
            },
            "triggers": {
                "When_a_file_is_created_ResponseFile": {
                    "recurrence": {
                        "interval": 3,
                        "frequency": "Minute"
                    },
                    "splitOn": "@triggerBody()?['value']",
                    "metadata": {
                        "flowSystemMetadata": {
                            "swaggerOperationId": "GetOnUpdatedFileItems"
                        }
                    },
                    "type": "ApiConnection",
                    "inputs": {
                        "host": {
                            "connection": {
                                "name": "@parameters('$connections')['shared_sharepointonline']['connectionId']"
                            }
                        },
                        "method": "get",
                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://' , parameters('envpar_config__TenantName') , '.sharepoint.com/sites/', parameters('envpar_config__CycleZeroName')))}/tables/@{encodeURIComponent(encodeURIComponent('SurveyQuiz'))}/onupdatedfileitems",
                        "authentication": "@parameters('$authentication')"
                    },
                    "conditions": [
                        {
                            "expression": "@equals( triggerBody()?['{ModerationStatus}'], 'Pending' )"
                        },
                        {
                            "expression": "@contains( triggerBody()?['{ContentType}']?['Name'] , '__' )"
                        },
                        {
                            "expression": "@not(startsWith( toLower(triggerBody()?['{FilenameWithExtension}']) , toLower(concat(triggerBody()?['{ContentType}']?['Name'], '.docx')) ))"
                        },
                        {
                            "expression": "@endsWith( toLower(triggerBody()?['{Path}']) , toLower(concat(first(split(triggerBody()?['{ContentType}']?['Name'],'__')), '/')) )"
                        },
                        {
                            "expression": "@not(endsWith( toLower(triggerBody()?['{FilenameWithExtension}']) , toLower('__SOLUTION.docx') ))"
                        },
                        {
                            "expression": "@less( float(triggerBody()?['{VersionNumber}']), 1.0 )"
                        }
                    ]
                }
            },
            "actions": {
                "HTTP": {
                    "runAfter": {},
                    "type": "Http",
                    "inputs": {
                        "method": "POST",
                        "uri": "@parameters('envpar_http__SurveyQuiz')",
                        "body": {
                            "siteName": "tplparam_cyclname",
                            "fileItemId": "@triggerOutputs()?['body/ID']",
                            "driveId": "tplparam_cycldriveid"
                        },
                        "retryPolicy": {
                            "type": "none"
                        }
                    }
                }
            }
        }
    },
    "schemaVersion": "1.0.0.0"
}